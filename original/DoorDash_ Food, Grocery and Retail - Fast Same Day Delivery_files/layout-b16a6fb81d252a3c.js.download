
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2ba8d16b-b325-51d3-86b4-4a4e41e022a8")}catch(e){}}();
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="08593f60-f031-41b6-8ffe-719342360fe0",e._sentryDebugIdIdentifier="sentry-dbid-08593f60-f031-41b6-8ffe-719342360fe0")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11817],{967756:function(e,t,n){Promise.resolve().then(n.bind(n,469467)),Promise.resolve().then(n.bind(n,540216)),Promise.resolve().then(n.bind(n,688403)),Promise.resolve().then(n.bind(n,531753)),Promise.resolve().then(n.bind(n,645327)),Promise.resolve().then(n.bind(n,815814)),Promise.resolve().then(n.bind(n,141621)),Promise.resolve().then(n.bind(n,49937)),Promise.resolve().then(n.bind(n,692148)),Promise.resolve().then(n.bind(n,13794)),Promise.resolve().then(n.bind(n,203516)),Promise.resolve().then(n.bind(n,165214)),Promise.resolve().then(n.bind(n,874953)),Promise.resolve().then(n.bind(n,99803))},13868:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r,i,a=n(313773),s=n(695229),o=n(509300),l=n(641760),d=n(918564),c=n(918821),u=(0,d.default)(c.Z).attrs(function(e){return(0,l.__assign)({size:e.insetSize,horizontalSize:e.insetHorizontalSize,verticalSize:e.insetVerticalSize},e.insetProps)}).withConfig({displayName:"ButtonGroupWrapper",componentId:"sc-wnfbvk-0"})(r||(r=(0,l.__makeTemplateObject)(["\n  ","\n  ","\n  ","\n    \n  //  The code below is to recreate the css gap property. Once we drop IE 11 support, this can be removed for gap.\n  max-width: none;\n  ","\n\n  & > * {\n    ","\n  }\n"],["\n  ","\n  ","\n  ","\n    \n  //  The code below is to recreate the css gap property. Once we drop IE 11 support, this can be removed for gap.\n  max-width: none;\n  ","\n\n  & > * {\n    ","\n  }\n"])),function(e){return e.layout===s.Zu.stack?"display: flex;":"display: grid;"},function(e){var t=e.columnCount,n=e.layout;if(n===s.Zu.stack)return"flex-direction: column;";var r="auto";n===s.Zu.fill&&(r="1fr");var i=[];return Array.from(Array(t).keys()).forEach(function(){return i.push(r)}),n===s.Zu.split&&i.splice(1,0,"1fr"),"grid-template-columns: ".concat(i.join(" "),";")},function(e){var t=e.itemAlignment;return e.layout!==s.Zu.stack?"align-items: ".concat(t,";"):""},function(e){return"margin: calc(".concat(e.itemGap," / -2) calc(").concat(e.itemGap," / -2);")},function(e){return"margin: calc(".concat(e.itemGap," / 2) calc(").concat(e.itemGap," / 2);")}),h=d.default.div.withConfig({displayName:"ButtonGroupSpacer",componentId:"sc-wnfbvk-1"})(i||(i=(0,l.__makeTemplateObject)(["\n  margin: 0 !important;\n"],["\n  margin: 0 !important;\n"]))),p=n(190510),v=n(549736),g=function(e){var t=e.slot,n=e.slotType;return t?"function"!=typeof t&&t.content?a.createElement("div",null,a.createElement(p.Z,(0,l.__assign)({type:n===s.xJ.primary?void 0:n===s.xJ.exit?v.L$.flatSecondary:v.L$.tertiary,onClick:t.onClick},t.buttonProps),t.content)):a.createElement("div",null,t()):a.createElement(h,null)},m=function(e){var t=e.layout,n=void 0===t?s.Zu.split:t,r=e.insetSize,i=void 0===r?o.wM.medium:r,l=e.insetHorizontalSize,d=e.insetVerticalSize,c=e.insetProps,p=e.itemGap,v=void 0===p?o.wM.xSmall:p,m=e.itemAlignment,f=void 0===m?s.bH.center:m,b=e.primaryAction,y=e.secondaryAction,S=e.tertiaryAction,C=e.exitAction,_=0;n===s.Zu.split?_=4:(b&&(_+=1),y&&(_+=1),S&&(_+=1),C&&(_+=1));var x={key:"exit",action:C,type:s.xJ.exit},P={key:"tertiary",action:S,type:s.xJ.tertiary},j={key:"secondary",action:y,type:s.xJ.secondary},T={key:"primary",action:b,type:s.xJ.primary},k=[n!==s.Zu.split&&x,P,{action:void 0,key:"spacer",type:void 0},n===s.Zu.split&&x,j,T].filter(function(e){return n!==s.Zu.split&&e?!!e.action:!!e}),w=n===s.Zu.stack?k.reverse():k;return a.createElement(u,{layout:n,columnCount:_,insetSize:i,insetHorizontalSize:l,insetVerticalSize:d,insetProps:void 0===c?{}:c,itemGap:v,itemAlignment:f},w.map(function(e){return e&&"spacer"===e.key?a.createElement(h,{key:e.key}):e?a.createElement(g,{key:e.key,slot:e.action,slotType:e.type}):null}))};m.displayName="ButtonGroup.Prism";var f=m},695229:function(e,t,n){"use strict";var r,i,a,s,o,l;n.d(t,{Zu:function(){return r},bH:function(){return i},xJ:function(){return a}}),(s=r||(r={})).split="LAYOUTS/SPLIT",s.fill="LAYOUTS/FILL",s.stack="LAYOUTS/STACK",(o=i||(i={})).center="center",o.flexStart="flex-start",o.flexEnd="flex-end",o.baseline="baseline",o.stretch="stretch",(l=a||(a={})).primary="SLOTTYPES/PRIMARY",l.secondary="SLOTTYPES/SECONDARY",l.tertiary="SLOTTYPES/TERTIARY",l.exit="SLOTTYPES/EXIT"},457182:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var r=n(641760),i=n(313773),a=n(74152),s=n(546725),o=function(e){var t=e.children,n=e.shouldAnimate,o=(0,r.__read)(i.useState(null),2),l=o[0],d=o[1],c=i.useRef({}),u=i.useRef("undefined"==typeof document?null:document),h=i.useRef(0),p=function(e){return h.current=h.current+1,d(function(t){var n;return(0,r.__assign)((0,r.__assign)({},t),((n={})[h.current]=e,n))}),h.current},v=function(e){d(function(t){return Object.fromEntries(Object.entries(t||{}).filter(function(t){return(0,r.__read)(t,1)[0]!==e.toString()}))})},g=function(e,t){d(function(n){var i;return(0,r.__assign)((0,r.__assign)({},n),((i={})[e]=t,i))})},m=(0,r.__read)(Object.entries(l||{}).find(function(e){return(0,r.__read)(e,2)[1].isOpen})||[],2),f=m[0],b=m[1];void 0!==b?c.current=b:c.current=(0,r.__assign)((0,r.__assign)({},c.current),{isOpen:!1});var y=i.useMemo(function(){return{attachToRef:u,registerModal:p,updateModal:g,removeModal:v}},[]);return i.createElement(s.E.Provider,{value:y},i.createElement(i.Fragment,null,t,i.createElement(a.Z,(0,r.__assign)({},c.current,{shouldAnimate:n,ejectFromModalManager:!0,__modalManagedId:f?null==f?void 0:f.toString():void 0}))))};o.displayName="ModalManager.Prism"},687204:function(e,t,n){"use strict";n.d(t,{Q:function(){return r}});let r=(0,n(309088).Ue)(e=>({guestNotifications:[],setGuestNotifications:t=>e({guestNotifications:t}),showGuestExperience:!1,setShowGuestExperience:t=>e({showGuestExperience:t}),showGuestLoginModal:!1,setShowGuestLoginModal:t=>e({showGuestLoginModal:t})}))},522840:function(e,t,n){"use strict";n.d(t,{f:function(){return r}});let r=(0,n(309088).Ue)(e=>({showNotificationsContainer:!1,setShowNotificationsContainer:t=>e({showNotificationsContainer:t}),hasViewedNotifications:!1,setHasViewedNotifications:t=>e({hasViewedNotifications:t})}))},99803:function(e,t,n){"use strict";n.d(t,{DoorDashCommonClientLayout:function(){return is}});var r=n(361967),i=n(313773),a=n(902297),s=n(799952),o=n(321569),l=n(164671),d=n(918050),c=n(446169),u=n.n(c),h=n(484497),p=n(988617),v=n(527178),g=n(866904),m=n(396765),f=n(299891),b=n(379186),y=n(204425),S=n(560930),C=n(655914),_=n(918821),x=n(976333),P=n(222679),j=n(455639),T=n(629702),k=n(430001),w=n(846901),I=n(965456),L=n(751419),E=n(278884),R=n(566643),O=n(731690),N=n(173660),A=n(570257),Z=n(431325),D=n(846367),G=n(970501),B=n(23802),M=n(952066),U=n(354655),F=n(451052);let H=(e,t)=>{switch(t){case G.tcR.ENTRY_POINT_TYPE_DASH_CARD_HUB:return e?O.ZP.t("dashCardStrings_menuButton_subTextWithCashBack",{cashBackAvailable:e}):O.ZP.t("dashCardStrings_menuButton_subTextWithNoCashBack");case G.tcR.ENTRY_POINT_TYPE_DASH_CARD_APPLICATION:case G.tcR.ENTRY_POINT_TYPE_DASH_CARD_PRE_APPROVED_APPLICATION:case G.tcR.ENTRY_POINT_TYPE_UNSPECIFIED:default:return O.ZP.t("dashCardStrings_menuButton_subText")}},z=e=>{let t="UNSPECIFIED";return e===G.tcR.ENTRY_POINT_TYPE_UNSPECIFIED?t:(null==e?void 0:e.toString().split("ENTRY_POINT_TYPE_")[1])||t},V=()=>{var e,t,n,a,s,o;let l=(0,M.Sj)(),{isDoorDash:d}=(0,f.Z)(),{data:c,error:u}=(0,U.Z)({skip:!l||!d}),p=(null==c?void 0:null===(e=c.getDashCardAccountStatus)||void 0===e?void 0:e.uri)||"",v=null==c?void 0:null===(t=c.getDashCardAccountStatus)||void 0===t?void 0:t.shouldShowApplicationEntryPoint,g=(null==c?void 0:null===(s=c.getDashCardAccountStatus)||void 0===s?void 0:null===(a=s.rewardBalanceAvailable)||void 0===a?void 0:null===(n=a.monetaryValue)||void 0===n?void 0:n.displayString)||"",m=null==c?void 0:null===(o=c.getDashCardAccountStatus)||void 0===o?void 0:o.entryPointType,b=!l||!!u||!v||!d,y=H(g,m),S=z(m);return(i.useEffect(()=>{b||(0,F.V)(S)},[S,b]),b)?null:(0,r.jsx)(D.sR,{onClick:()=>(0,F.q)(S),"data-testid":B.Z.menuButton,title:O.ZP.t("dashCardStrings_menuButton_title"),subtext:y,icon:h.IconType.CardDoordashRewardsColor,iconStartProps:{useDefaultColors:!0,size:Z.J.medium},"data-anchor-id":"HamburgerMenuDashCardLink",href:p})};var W=n(655718),Q=n(378528),Y=n(410530),$=n(493260),q=n(699251),K=n(724590),J=n(539599),X=n(225340),ee=n(163941),et=n(961242),en=n(455544),er=n(155751);let ei=e=>{let{isGuest:t}=e,{getLoginUrl:n,getLogoutUrl:i}=(0,$.Yq)(),a=(0,en.u)(),{showLoginInModalExpEnabled:s,showSignInSignUpModal:o,setShowSignInSignUpModal:l,onIdentityLinkClick:d}=(0,J.N)(),[c]=(0,er.j)();return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K.L,{isOpen:o,setShowSignInSignUpModal:l,onClose:()=>l(!1),"data-test-id":et._.loginModal}),(0,r.jsx)(ee.Uk,{title:O.ZP.t("layoutStrings_userMenu_signUpIn"),icon:h.IconType.PersonProfileLine,href:n(),"data-test-id":et._.userLoginButton,onClick:e=>{s&&(e.preventDefault(),d()),(0,j.j)("efs_landing_signin_click")}})]}):(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_signOut"),isSeparatorVisible:!1,"data-anchor-id":"UserLogOutButton","data-test-id":et._.userLogoutButton,onClick:()=>{q.simpleStoreSession.get(X.s)&&q.simpleStoreSession.delete(X.s),c({variables:{optIn:!1}}),(0,j.j)("signout_click"),(0,j.j)("logout_button_click"),a.markEventStart(),a.markEventEndWithOptionalData({replaceContextBeforeEventEmit:(e,t)=>({...t,globalContext:{...t.globalContext,address:void 0}})})},href:i()})};var ea=n(210253),es=n(54147),eo=n(994213),el=n(161539),ed=n(559510),ec=n(856120),eu=n(566969);let eh={[m.a.DoorDash]:{helpLink:"/help/",aboutLink:"/about/",careersLink:"/careers/",blogLink:N.jY.blogUrl,engineeringLink:N.jY.engineering,engineeringBlogLink:N.jY.engineeringBlog,accessibilityLink:"/accessibility/",dasherApplyLink:"/dasher/apply/",merchantApplyLink:"/merchant/apply/?internal-referrer=nav_menu",rewardsWalletLink:"/loyalty/wallet"}},ep=[N.ZP.dashpass,N.ZP.manageSubscription,N.ZP.savedStores,N.ZP.dietaryPreferences,N.ZP.savedGroupList,N.ZP.help,N.ZP.giftCardRedeem,N.ZP.referralInvite,N.ZP.profile,N.ZP.benefits,N.ZP.payment,eh[m.a.DoorDash].rewardsWalletLink],ev=()=>{let e=(0,eo.l)(),{consumer:t}=(0,E.R)();if(!t.isGuest&&e&&t.id){let e=(0,ec.O)(t.id);ep.push(e)}return ep},eg=e=>{var t,n,i;let{consumer:a}=e,s=(0,P.jb)(e=>e.state),{experience:o}=(0,f.Z)(),{data:l}=(0,x.j)({experience:o,isGuest:a.isGuest}),d=(0,es.W)(),c=(0,w.ST)(),u=(0,eu.y)(),p=null!==(i=a.isGuest)&&void 0!==i&&i,v=!p,g=(0,L.Z)(),{helpLink:E,rewardsWalletLink:Z}=eh[m.a.DoorDash],{enableSaveForLater:G}=(0,T.M)(),{isDashpassUpsellEnabled:B}=(0,A._)(a),M=(0,eo.l)(),{profileStatus:U,profileImageUrl:F,isLoading:H}=(0,el.U)({consumerId:a.id||"",isGuest:p});return(0,r.jsxs)("div",{"data-testid":R.m.userMenu,children:[M&&!p&&a.id&&(0,r.jsx)(D.sR,{title:(0,r.jsx)(ed.f,{formalNameAbbreviated:(null===(t=a.localizedNames)||void 0===t?void 0:t.formalNameAbbreviated)||"",profileStatus:U,profileImageUrl:F,isLoading:H}),accessibilityLabel:O.ZP.t("consumerProfilePageStrings_view_profile"),href:"".concat((0,ec.O)(a.id),"?source=account_tab")}),B&&(0,r.jsx)(Q.Z,{consumer:a}),(0,r.jsx)(V,{}),(0,r.jsx)(W.Z,{consumer:a,shouldUseV2:!0}),G&&(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_savedStores"),accessibilityLabel:O.ZP.t("layoutStrings_userMenu_savedStores"),icon:h.IconType.FavoriteLine,href:N.ZP.savedStores}),u&&(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_myRewards"),accessibilityLabel:O.ZP.t("layoutStrings_userMenu_myRewards"),icon:h.IconType.RewardLine,href:Z}),g&&(0,r.jsx)(D.sR,{title:O.ZP.t("dietaryPreferences_content_dietary_preferences"),accessibilityLabel:O.ZP.t("dietaryPreferences_content_dietary_preferences"),icon:h.IconType.FilterFill,href:"".concat(N.ZP.dietaryPreferences,"?entryPoint=userMenu")}),c&&"ready"===s&&(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_savedGroups"),accessibilityLabel:O.ZP.t("layoutStrings_userMenu_savedGroups"),icon:h.IconType.PeopleGroupLine,href:N.ZP.savedGroupList,onClick:()=>{(0,w.cU)(),(0,k.rn)()}}),(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_help"),icon:h.IconType.ChatDefaultLine,href:v?N.ZP.help:E,onClick:()=>{(0,j.j)("usermenu_help_click",{help_experience:v?"order_history":"external_help"})}}),(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_giftCard"),icon:h.IconType.GiftLine,href:"".concat(N.ZP.giftCardRedeem,"?from_menu_link=true"),"data-anchor-id":"HamburgerMenuGiftCardPageLink"}),!p&&(0,r.jsx)(b.iS,{overrides:e=>{let{usage:t}=e;return{usage:{color:{transparent:t.color.highlight.subdued}}}},children:(0,r.jsx)(D.sR,{icon:h.IconType.PeopleGroupLine,title:p?O.ZP.t("layoutStrings_userMenu_getDDCredits"):O.ZP.t("layoutStrings_userMenu_getCreditsAmt",{creditAmount:(0,I.i)()}),href:N.ZP.referralInvite})}),!p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.Z,{}),(0,r.jsx)(ea.nC,{children:(0,r.jsx)(S.x,{textStyle:C.TextStyle.title.medium,children:O.ZP.t("layoutStrings_userMenu_accountSettings")})}),!d&&(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_account"),subtext:null==a?void 0:null===(n=a.localizedNames)||void 0===n?void 0:n.formalName,accessibilityLabel:O.ZP.t("layoutStrings_userMenu_account"),href:N.ZP.profile,"data-anchor-id":"HamburgerMenuProfilePageLink"}),!!l&&(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_benefits"),subtext:(null==l?void 0:l.name)||"",accessibilityLabel:O.ZP.t("layoutStrings_userMenu_benefits"),href:N.ZP.benefits,"data-anchor-id":"HamburgerMenuCorporatePortalLink"}),(0,r.jsx)(D.sR,{title:O.ZP.t("layoutStrings_userMenu_payment"),href:N.ZP.payment,"data-anchor-id":"HamburgerMenuPaymentPageLink"}),(0,r.jsxs)(ea.S$,{children:[(0,r.jsx)(S.x,{textStyle:C.TextStyle.body.medium.default,children:"Language"}),(0,r.jsx)(_.Z,{children:(0,r.jsx)(Y.Z,{})})]}),(0,r.jsx)(ei,{isGuest:p})]})]})};var em=n(934681);let ef=e=>{let{title:t}=e,{consumer:n}=(0,E.R)();return(0,r.jsx)(em.Z,{title:t,children:(0,r.jsx)(eg,{consumer:n})})},eb=e=>(0,r.jsx)(g.Z,{...e,popoverContent:(0,r.jsx)(ef,{title:e.label}),modalProps:{hasContentPadding:!1,isFullScreenOnMobile:!0,hasHeaderPadding:!0}});var ey=n(706619),eS=n(1114);let eC=e=>{let{showSignInSignUpModal:t,setShowSignInSignUpModal:n}=(0,J.N)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eS.X$,{...e,onClick:()=>n(!0)}),(0,r.jsx)(K.L,{isOpen:t,setShowSignInSignUpModal:n,onClose:()=>n(!1)})]})};var e_=n(762088),ex=n(290130);let eP=()=>{let e=(0,ex.H)(),t="US"===e,n=t||"CA"===e||"AU"===e;return(0,i.useMemo)(()=>u()([n&&{id:p.zU.GROCERY,label:O.ZP.t("layoutStrings_userSideNav_grocery"),route:p.UW.grocery,icon:h.IconType.GroceryLine,svg:p.OH.GroceryLine,routeAliases:["/p/grocery-delivery","/tabs-next/grocery"]},t&&{id:p.zU.RETAIL,label:O.ZP.t("layoutStrings_userSideNav_retail"),route:p.UW.retail,icon:h.IconType.RetailLine,svg:p.OH.RetailLine,routeAliases:["/tabs-next/retail"]},{id:p.zU.CONVENIENCE,label:O.ZP.t("layoutStrings_userSideNav_convenience"),route:p.UW.convenience,icon:h.IconType.IceCreamDrinkLine,svg:p.OH.IceCreamDrinkLine},{id:p.zU.OFFERS,label:O.ZP.t("layoutStrings_userSideNav_offers"),route:p.UW.offers,icon:h.IconType.DealsLine,svg:p.OH.DealsLine}]),[n,t])};var ej=n(815662),eT=n(249478);let ek=()=>{let{isMobile:e}=(0,eT.ac)(),t=eP(),n=(0,ej.Z)(),r=n.length?n:t,a=ev();return(0,i.useMemo)(()=>[{label:void 0,tabs:[{id:p.zU.HOME,label:O.ZP.t("layoutStrings_userSideNav_home"),route:v._.loggedInHome,icon:h.IconType.HomeLine,svg:p.OH.HomeLine,routeAliases:[v._.home,"/next"]},e&&{id:p.zU.PICKUP,label:O.ZP.t("layoutStrings_userSideNav_pickup"),route:v._.pickup,icon:h.IconType.OrderBagLine,svg:p.OH.OrderBagLine},...r,{id:p.zU.BROWSE,label:O.ZP.t("layoutStrings_userSideNav_browse"),route:v._.browse,icon:h.IconType.BrowseTabLine,svg:p.OH.BrowseTabLine}]},{label:void 0,tabs:[{id:p.zU.ORDERS,label:O.ZP.t("layoutStrings_userSideNav_orders"),route:v._.orders,icon:h.IconType.ReceiptLine,svg:p.OH.ReceiptLine},{id:p.zU.ACCOUNT,label:O.ZP.t("layoutStrings_userSideNav_account"),icon:h.IconType.PersonProfileLine,svg:p.OH.PersonProfileLine,isActiveItemChangeDisabled:!0,ItemComponent:eb,routeAliases:a}],SectionComponent:ey.Z},{label:void 0,tabs:[{id:p.zU.SIGN_IN,label:O.ZP.t("layoutStrings_userSideNav_signIn"),icon:h.IconType.PersonProfileLine,svg:p.OH.PersonProfileLine,isActiveItemChangeDisabled:!0,ItemComponent:eC}],SectionComponent:e_.Z}].map((e,t)=>{let{tabs:n,...r}=e;return{tabs:u()(n).map((e,n)=>({...e,sectionIndex:t,tabIndex:n})),...r}}),[e,r,a])};var ew=n(95660),eI=n(376457);let eL=e=>{let{data:t,isCompact:n,isSideNavExpandedByHamburgerButton:a}=e,[s,c]=i.useState(!1),u=(0,ew.W6)()();return i.useEffect(()=>{if(!s)return;let e=setTimeout(()=>{c(!1)},1e4);return()=>clearTimeout(e)},[s]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eI.dj,{children:(0,r.jsx)(d.Z,{data:t,isCompact:n,isSideNavExpandedByHamburgerButton:a,onNavigate:()=>{u||c(!0)}})}),(0,r.jsx)(eI.rR,{isCompact:n,children:(0,r.jsx)(o.Z,{isAnimated:!0,isVisible:s,type:l.j.light})})]})},eE=e=>{let{isCompact:t}=e,{isSideNavCompact:n,isSideNavPresentingOnLeft:i,isSideNavExpandedByHamburgerButton:a}=(0,s.D)(),o=ek();return i?(0,r.jsx)(eL,{data:o,isCompact:t||n,isSideNavExpandedByHamburgerButton:a}):null};var eR=n(329793),eO=n(418601),eN=n(858611),eA=n(377961),eZ=n(214515),eD=n(469894),eG=n(177560),eB=n(117874),eM=n(232755),eU=n(509300),eF=n(88750),eH=n(529033);let ez=(0,eD.default)(()=>n.e(42546).then(n.bind(n,342546)),{loadableGenerated:{webpack:()=>[342546]},ssr:!1}),eV=i.memo(e=>{let{cartUuid:t,storeId:n,storeName:i,storeUrl:a,hasBundleStore:s,isConvenienceCart:o,checkoutOverridePageType:l,orders:d,isGuest:c,orderCartCurrencyCode:u,setShowCartSidebar:h,isPrescriptionDelivery:p}=e;return(0,r.jsxs)(eZ.hH,{children:[(0,r.jsx)(eG.Z,{"data-testid":"dbd-pre-checkout-header-overlay-close-button",iconType:eB.L.Close,accessibilityLabel:O.ZP.t("stores_close"),onClick:()=>h(!1)}),(0,r.jsxs)(eM.Z,{size:eU.Uo.none,style:{flex:1},children:[(0,r.jsx)(S.x,{textStyle:C.TextStyle.label.xSmall.strong,color:C.d9.text.subdued.default,children:O.ZP.t("layoutStrings_orderCart_storeLabel")}),s?(0,r.jsx)(S.x,{textStyle:C.TextStyle.title.medium,children:O.ZP.t("doubledash_pre_checkout_bundled_order_header_v2",{storeName:i})}):(0,r.jsx)(eF.Z,{storeId:n,restaurantName:null!=i?i:"",storeUrl:a,additionalTrackingData:{isPrescriptionDelivery:String(p)}})]}),(0,r.jsx)(eZ.pr,{children:(0,r.jsx)(ez,{isButtonInline:!0,isDisabled:!1,handleDisplayPromoModal:eH.F,cartId:t,storeId:n,orders:d,isGuestConsumer:c,isGroupOrder:!1,bundleOrderCartId:void 0,subtotal:0,isCashTransaction:!1,currency:u,isOrderCartLoading:!1,isConvenienceCart:o,staticMapAddress:null,checkoutOverridePageType:l,showSubtotal:!1})})]})});var eW=n(628089),eQ=n(905954);let eY=i.memo(e=>{let{setShowCartSidebar:t}=e,n=i.useRef(null),[a,s]=i.useState(!1),{setFloatingCheckoutVisible:o}=(0,eQ.E_)(e=>({setFloatingCheckoutVisible:e.setFloatingCheckoutVisible})),{shouldRenderSideSheet:l,storeId:d,businessName:c,storeUrl:u,hasBundleStore:h,cartUuid:p,isConvenienceCart:v,checkoutOverridePageType:g,orders:m,isGuest:f,orderCartCurrencyCode:b,isPrescriptionDelivery:y}=(0,eA.k)();return((0,eW.G)({headerPlaceholderRef:n,setShowFixedHeader:s}),l)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eZ.A_,{ref:n,children:(0,r.jsx)(eG.Z,{"data-testid":"dbd-pre-checkout-header-close-button",iconType:eB.L.Close,accessibilityLabel:O.ZP.t("stores_close"),onClick:()=>{t(!1),o(!1)}})}),(0,r.jsx)(eZ.$l,{in:a,children:(0,r.jsx)(eV,{storeId:d,storeName:c,storeUrl:u,hasBundleStore:h,setShowCartSidebar:t,cartUuid:p,isConvenienceCart:v,checkoutOverridePageType:g,orders:m,isGuest:f,orderCartCurrencyCode:b,isPrescriptionDelivery:y})})]}):null}),e$=e=>{let{setShowCartSidebar:t}=e;return(0,eA.k)().shouldRenderSideSheet?{getPreCheckoutSideSheetHeader:()=>(0,r.jsx)(eY,{setShowCartSidebar:t})}:{getPreCheckoutSideSheetHeader:void 0}},eq=e=>{let{children:t,isOpen:n,setShowCartSidebar:i}=e,{getPreCheckoutSideSheetHeader:a}=e$({setShowCartSidebar:i});return(0,r.jsx)(eN.Z,{shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,isOpen:n,onClose:()=>{i(!1)},hasContentPadding:!1,renderHeader:a,children:t})};var eK=n(159967),eJ=n(30541),eX=n(918564),e0=n(943327),e1=n(823302),e4=n(392017),e6=n(264124),e5=n(594230),e7=n(479663),e3=n(808844),e9=n(903104),e2=n(765255),e8=n(152724),te=n(516912);let tt=()=>{let e=(0,e8.p)(),t=(0,te.w)(e)?e:null;return t?{hasPostCheckoutCart:!0,postCheckoutCartFilter:t?{shouldIncludeSubmitted:!0}:null,postCheckoutCartRefetchQueries:["PreviewOrderUpdate","listCarts"],postCheckoutCart:t}:{hasPostCheckoutCart:!1,postCheckoutCart:null,postCheckoutCartFilter:null,postCheckoutCartRefetchQueries:[]}};var tn=n(260014),tr=n(714313);let ti=()=>{let e="true"===new URLSearchParams((0,tr.TH)().search).get("enable_loyalty"),{storeInformation:{loyaltyProgramId:t="",loyaltyProgramTestMode:n=!0}}=(0,tn.TX)();return!!t&&(!n||e)},ta={programId:"",isLoyalty:!1,isExternalLoyalty:!1,isInternalLoyalty:!1,isExternalLoyaltyWithInternalLogin:!1},ts=e=>["spoton_staging","spoton_production"].includes(e.toLowerCase()),to=()=>{let e=ti(),{storeInformation:{loyaltyProgramId:t="",loyaltyProgramProviderType:n=""}}=(0,tn.TX)(),r=ts(n);return e?{programId:t,isLoyalty:!0,isExternalLoyalty:"DOORDASH"!==n,isInternalLoyalty:"DOORDASH"===n,isExternalLoyaltyWithInternalLogin:r}:ta},tl=()=>{let e=to();return e.isInternalLoyalty?{...e,programId:e.programId}:{...e,programId:""}},td=()=>{let{isStorefront:e}=(0,f.Z)(),{isInternalLoyalty:t}=tl();return e&&!t};var tc=n(807515),tu=n(729724);let th=(0,eD.default)(()=>n.e(1445).then(n.bind(n,801445)),{loadableGenerated:{webpack:()=>[801445]},ssr:!1}),tp=(0,eD.default)(()=>Promise.all([n.e(57743),n.e(80188),n.e(86751),n.e(14551),n.e(48414),n.e(43247),n.e(93161),n.e(60579),n.e(21689),n.e(70644),n.e(93747),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(46469),n.e(94057),n.e(36647),n.e(88421),n.e(66600),n.e(97226),n.e(44446),n.e(18666),n.e(60672),n.e(46150),n.e(79425)]).then(n.bind(n,260672)),{loadableGenerated:{webpack:()=>[260672]},ssr:!1}),tv=(0,eD.default)(()=>n.e(61675).then(n.bind(n,561675)),{loadableGenerated:{webpack:()=>[561675]},ssr:!1}),tg=(0,eD.default)(()=>n.e(93532).then(n.bind(n,293532)),{loadableGenerated:{webpack:()=>[293532]},ssr:!1}),tm=(0,eD.default)(()=>Promise.all([n.e(1042),n.e(7648),n.e(57743),n.e(80188),n.e(86751),n.e(14551),n.e(48414),n.e(43247),n.e(93161),n.e(60579),n.e(21689),n.e(13899),n.e(70644),n.e(5491),n.e(93747),n.e(76774),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(8334),n.e(46469),n.e(94057),n.e(36647),n.e(78424),n.e(46585),n.e(33270),n.e(71500),n.e(77557),n.e(88421),n.e(58977),n.e(51239),n.e(74425),n.e(75906),n.e(36505),n.e(8370),n.e(40771),n.e(97226),n.e(76556),n.e(44446),n.e(83474),n.e(28460),n.e(18666),n.e(68129),n.e(82991),n.e(27023),n.e(79586),n.e(59362),n.e(46260),n.e(39720),n.e(83913),n.e(56304)]).then(n.bind(n,960906)),{loadableGenerated:{webpack:()=>[960906]},ssr:!1}),tf=(0,eD.default)(()=>Promise.all([n.e(1042),n.e(57743),n.e(14551),n.e(21689),n.e(5491),n.e(57590),n.e(77535),n.e(66544),n.e(8334),n.e(46469),n.e(36647),n.e(46585),n.e(88421),n.e(51239),n.e(74425),n.e(66600),n.e(40771),n.e(13347),n.e(76556),n.e(83474),n.e(28460),n.e(59362),n.e(32067),n.e(755)]).then(n.bind(n,151304)),{loadableGenerated:{webpack:()=>[151304]},ssr:!1}),tb=(0,eD.default)(()=>Promise.all([n.e(1042),n.e(7648),n.e(57743),n.e(80188),n.e(86751),n.e(14551),n.e(48414),n.e(43247),n.e(93161),n.e(60579),n.e(21689),n.e(13899),n.e(70644),n.e(5491),n.e(93747),n.e(76774),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(8334),n.e(46469),n.e(94057),n.e(36647),n.e(78424),n.e(46585),n.e(33270),n.e(71500),n.e(77557),n.e(88421),n.e(58977),n.e(51239),n.e(74425),n.e(75906),n.e(36505),n.e(8370),n.e(40771),n.e(97226),n.e(76556),n.e(44446),n.e(83474),n.e(28460),n.e(18666),n.e(68129),n.e(82991),n.e(27023),n.e(79586),n.e(59362),n.e(46260),n.e(39720),n.e(83913),n.e(51518),n.e(47684)]).then(n.bind(n,251518)),{loadableGenerated:{webpack:()=>[251518]},ssr:!1}),ty=(0,eD.default)(()=>Promise.all([n.e(14551),n.e(15687),n.e(51360),n.e(66544),n.e(46469),n.e(81114),n.e(75447),n.e(36647),n.e(50808),n.e(46585),n.e(88421),n.e(76556),n.e(95141),n.e(94409)]).then(n.bind(n,159010)),{loadableGenerated:{webpack:()=>[159010]},ssr:!1}),tS=(0,eD.default)(()=>Promise.all([n.e(21689),n.e(5491),n.e(57590),n.e(51239),n.e(74425),n.e(66600),n.e(40771),n.e(83474),n.e(51250)]).then(n.bind(n,883474)),{loadableGenerated:{webpack:()=>[883474]},ssr:!1}),tC=eX.default.div.withConfig({componentId:"sc-1a7c2937-0"})(["padding:",";"],eK.Q2.usage.space.legacyMedium),t_=(0,e5.gG)((0,tc.zH)(e=>{var t,n,i,s,o,l;let{consumer:d,onCloseModalComplete:c,onOpenModalComplete:u,orderCart:h,showStorefrontFulfillmentEta:p,store:v}=e,g=td(),{isLoading:m}=(0,a.re)(),f=!!(null==h?void 0:h.hasError),b=(0,e1.qr)(e=>e.pageType),{listDetailedCartsRes:{loading:y,data:S},shouldShowOpenCarts:C}=(0,e2.r)(),_=null==S?void 0:S.listDetailedCarts,{hasPostCheckoutCart:x,postCheckoutCart:P}=tt(),T=null!==(n=null==h?void 0:h.orders)&&void 0!==n?n:[],k=(0,e0.v)(T),{trackLoadSuccess:w,trackLoadFailure:I}=(0,e5.sH)(),L=!f&&!!h&&k>0,E=C&&(null!==(i=null==_?void 0:null===(t=_.detailedCarts)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>1;return m||y?(0,r.jsx)(tC,{"data-testid":e9.D.CartSidebarLoading,children:(0,r.jsx)(eJ.g,{})}):x&&P?(0,r.jsx)(ty,{orderCart:P,cartUuid:null!==(s=null==P?void 0:P.id)&&void 0!==s?s:""}):C?(w(j.j),(0,r.jsx)(tb,{orderCart:h,consumer:d,maxOpenCartsLimitReached:!!(null==_?void 0:_.maxOpenCartsLimitReached),detailedCarts:null!==(o=null==_?void 0:_.detailedCarts)&&void 0!==o?o:[]})):L?(w(j.j),g)?(0,r.jsx)(tf,{consumer:d,onCloseModalComplete:c,onOpenModalComplete:u,orderCart:h,showFulfillmentEta:p,store:v}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tm,{consumer:d,orderCart:h,hasOpenCarts:E,onOpenModalComplete:u,onCloseModalComplete:c}),!!(null==h?void 0:h.groupCart)&&(0,r.jsx)(th,{consumer:d,orderCart:h})]}):f?(I(j.j,{[e7.rI.internal_message]:O.ZP.t("layoutStrings_orderCart_messages_errorCart_title"),[e7.rI.consumer_id]:null!==(l=d.id)&&void 0!==l?l:"",[e7.rI.severity_level]:e7.aB.error}),(0,r.jsx)(tg,{})):b&&(0,e4.N)(b)?(w(j.j),(0,r.jsx)(tv,{emptyCartGraphic:(0,r.jsx)(e3.D,{})})):b===tu.G.GroupCartSSR&&d.id&&(null==h?void 0:h.groupCart)?(w(j.j),(0,r.jsx)(tp,{consumer:d,orderCart:h})):(w(j.j),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tv,{}),(0,r.jsx)(tS,{consumer:d,orderCart:h,isFixed:!0})]}))},{name:"OptimizedOrderCartLoader"}),{name:e6.KG.ORDER_CART_PAGE});var tx=n(763719),tP=n(161966);let tj=()=>{let{consumer:e}=(0,E.R)(),{orderCart:t}=(0,a.re)(),n=(0,tx.n)(),{showCartSidebar:s,setShowCartSidebar:o}=(0,tP.F)(),{setCartDisplayVariant:l}=(0,eQ.E_)(e=>({setCartDisplayVariant:e.setCartDisplayVariant})),d=i.useCallback(()=>o(!0),[o]);(0,eQ.u9)(d);let c=i.useCallback(()=>o(!1),[o]);(0,eQ.PN)(c),i.useEffect(()=>{l(n)},[n,l]),(0,eQ.hI)();let u={consumer:e,orderCart:t};return"fixed"===n?(0,r.jsx)(eO.I,{isOpen:s,setShowCartSidebar:o,children:(0,r.jsx)(t_,{...u})}):(0,r.jsx)(eq,{isOpen:s,setShowCartSidebar:o,children:(0,r.jsx)(t_,{...u})})};var tT=n(380858),tk=n(428596),tw=n(166331),tI=n(527901),tL=n(675156),tE=n(858995),tR=n(222047),tO=n(549736),tN=n(645827),tA=n(996870),tZ=n(350497),tD=n.n(tZ),tG=n(515663),tB=n(829832),tM=n(297105),tU=n(42823),tF=n(82282),tH=n(910213),tz=n(200469),tV=n(834370),tW=n(759790),tQ=n(833890),tY=n(851593),t$=n(637736),tq=n(343915);let tK=tD()(e=>e(),100),tJ=e=>{var t;let{isAriaExpanded:n,isDropdownVisible:a,onBlur:s,onChange:o,onSearch:l,setIsOpenDropdown:d,value:c,size:u,...p}=e,{entry:v}=(0,tF.cX)(),{isCaviar:g}=(0,f.Z)(),{collapse:m,isCollapsed:b,setLegoDriverParams:y,shouldCollapseOnClose:S}=(0,tM.AB)(),{push:C}=(0,tr.tv)(),_=(0,tr.TH)(),{deviceTypeString:x}=(0,tT.s)(),P=(0,tH.Z)(c),j=(0,tV.z)(),{onFocusHandler:T,eleRef:k,onKeyUpHandler:w,onChangeHandler:I}=(0,tW.E)({event:{viewEntityInfo:{entityType:"none"},standardizedView:{viewType:tQ.bW.SEARCH_INPUT,sectionType:tQ.bA.SEARCH_BAR,viewId:(0,tY.Ps)(tQ.bW.SEARCH_INPUT,{entityType:"none"})}}}),L=(0,t$.xk)(tQ.bW.SEARCH_CLEAR_BUTTON,{entityType:"none"}),E=(0,t$.xk)(tQ.bW.SEARCH_BACK_BUTTON,{entityType:"none"}),R=(0,tz.ZD)(),N=(0,e0.pC)(_.pathname,tG._j.legoSearch),A=i.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o(e),tK(()=>{l(e)})},[o,l]),D=i.useCallback(e=>{v===tU.Dw.MULTI_LOCATION_STORES?(y(e=>({...e,cursor:"",entry:tU.Dw.AUTOCOMPLETE})),A(P)):(e.stopPropagation(),A(""),d(!1),N&&window.history.back()),S&&m(!0)},[m,v,A,P,d,y,S,N]),G={accessibilityDescribedBy:"search-dropdown-results","aria-expanded":n,"aria-owns":"search-dropdown-results","data-accessibility-id":"header-search-input-field","data-anchor-id":"HeaderSearchInputField","data-lpignore":!0,value:c,onChange:e=>{A(e),I(e)},...p.autoComplete&&{autoComplete:p.autoComplete},onFocus:()=>{p.onFocus(),T(c)},onBlur:s,onKeyUp:e=>{p.onKeyUp(e,C),w(e,c)},size:null!=u?u:tk.J9.medium,placeholder:null!==(t=p.placeholder)&&void 0!==t?t:O.ZP.t("layoutStrings_header_searchInput_search"),label:g?O.ZP.t("caviar_layoutStrings_header_searchInput_storeSearch"):O.ZP.t("layoutStrings_header_searchInput_storeSearch"),isLabelHidden:!0,autoFocus:j};return(0,r.jsx)(tB.mc,{"data-anchor-id":"HeaderSearchInput",deviceType:x,isOpenDropdown:a,isNotificationHubHeaderRedesignEnabled:R,onClick:()=>{b&&m(!1)},children:(0,r.jsx)(tA.Z,{inputMode:"search",renderAfterContent:(null==c?void 0:c.length)&&!b?()=>(0,r.jsx)(tB.sV,{children:(0,r.jsx)(eG.Z,{accessibilityLabel:O.ZP.t("layoutStrings_header_clear_input"),"data-testid":tq.n.clearSearchButton,iconType:eB.L.CloseCircleFill,onClick:e=>{v===tU.Dw.MULTI_LOCATION_STORES&&y(e=>({...e,cursor:"",entry:tU.Dw.AUTOCOMPLETE})),L(e),A("")},size:eB.rm.medium})}):void 0,renderBeforeContent:()=>n?(0,r.jsx)(tB.sV,{children:(0,r.jsx)(eG.Z,{accessibilityLabel:O.ZP.t("layoutStrings_header_exit_search"),"data-testid":tq.n.backArrowButton,iconType:eB.L.ArrowLeft,onClick:e=>{E(e),D(e)},size:eB.rm.medium,type:tO.xZ.flatSecondary})}):(0,r.jsx)(tB.ee,{isCollapsed:b,children:(0,r.jsx)(tN.Z,{type:h.IconType.Search,size:Z.J.medium,color:h.EY.text.subdued.default})}),...G,interfaceRef:k})})};var tX=n(32850),t0=n(380051),t1=n(971337),t4=n(221129),t6=n(595118);let t5=(0,eD.default)(()=>Promise.all([n.e(7648),n.e(34069)]).then(n.bind(n,634069)),{loadableGenerated:{webpack:()=>[634069]},ssr:!1}),t7=e=>{let{data:t,isOpenDropdown:n,isReadyToOpenDropdown:a,setIsOpenDropdown:s,placeholder:o,overrideNavigateOnEnter:l,navigateOnInputBlur:d,searchListMaxHeight:c,searchQuery:u,...h}=e,p=(0,tF.cX)(),{entry:v,logger:g,query:m,dispatchEvent:f}=p,{isCollapsed:b,setLegoDriverParams:y}=(0,tM.AB)(),[S,C]=i.useState(u||""),[_,x]=i.useState(-1),P=i.useRef(!1),j=i.useRef(null),T=i.useCallback(e=>{C((0,t4.Z)(e))},[C]);i.useEffect(()=>{T(u)},[u,T]);let k=i.useRef(!1),w=i.useRef(!1),I=a&&n&&!w.current&&t&&(0,t0.x8)(t);i.useEffect(()=>{b&&I&&s(!1)},[b,I,s]);let L=i.useCallback(()=>(0,tX.QI)(),[]),E=i.useCallback((e,t)=>{e&&e.focus(),document.activeElement===e?x(t):x(-1)},[x]),R=i.useCallback(e=>{f({name:tU.dW.QUERY,data:{query:e}},t)},[t,f]),O=i.useCallback(e=>{v===tU.Dw.MULTI_LOCATION_STORES&&y(e=>({...e,entry:tU.Dw.AUTOCOMPLETE})),C(e),w.current=!1},[v,y]),A=i.useCallback(e=>{var t,n,r,i,a,o,l;let c=null==e?void 0:null===(n=e.relatedTarget)||void 0===n?void 0:null===(t=n.dataset)||void 0===t?void 0:t.testid,h=null==e?void 0:null===(i=e.relatedTarget)||void 0===i?void 0:null===(r=i.dataset)||void 0===r?void 0:r.path,p=null==e?void 0:null===(o=e.relatedTarget)||void 0===o?void 0:null===(a=o.dataset)||void 0===a?void 0:a.title;if(c===t6._.appDownloadButton){P.current=!0;return}if(S||T(u),"see-all-locations-button"===c){C((null==e?void 0:null===(l=e.relatedTarget)||void 0===l?void 0:l.value)||""),E(L(),-1);return}if("remove-result-button"===c){E(L(),-1);return}if(![tq.n.backArrowButton,tq.n.clearSearchButton].includes(null!=c?c:"")){if(j.current===t6._.appDownloadButton){j.current=null;return}k.current?k.current=!1:(s(!1),x(-1)),d&&h&&(d(h),C(null!=p?p:""),R(null!=p?p:""))}},[S,u,d,R,s,x,C,T,E,L]),Z=()=>{k.current=!0;let e=(0,tX.$1)(!0);_<0&&e&&E(e[0],0)},D=()=>{let e=(0,tX.$1)(!0);e&&_<0&&(k.current=!0,E(e[e.length-1],e.length-1))},G=i.useCallback(()=>{P.current=!0,j.current=t6._.appDownloadButton,setTimeout(()=>{P.current=!1,j.current=null,A()},500)},[A]);return(0,r.jsx)(tE.E,{isOpen:I,setContentWidthAsAnchorWidth:!0,position:tR.eW.bottomCenter,boundariesElement:tR.Q$.scrollParent,offset:[tR.O6.none,tR.O6.small],boundariesPadding:tR.O6.none,shouldAutomaticallyFlip:!1,anchorContainerDisplayMode:"block",content:(0,r.jsx)(tF.e0,{value:p,children:(0,r.jsx)("div",{onTouchStart:e=>{e.target.closest('[data-testid="'.concat(t6._.appDownloadButton,'"]'))&&G()},children:(0,r.jsx)(t5,{data:t,onBlur:e=>{!P.current&&(e.currentTarget.contains(e.relatedTarget)||e.relatedTarget===L()||(k.current=!1,A()))},onKeyDown:e=>{let t=(0,tX.$1)(!0);switch(e.keyCode){case tX.nx.ENTER:k.current=!1,A();break;case tX.nx.ESC:k.current=!1,E(L(),-1),A();break;case tX.nx.TAB:e.preventDefault(),k.current=!1,e.shiftKey?E(document.querySelector('[data-accessibility-id="header-homepage-link"]'),-1):E(document.querySelector('[data-accessiblity-id="header-order-cart"]'),-1),A();break;case tX.nx.DOWN:e.preventDefault(),t&&_>-1&&(_>=t.length-1?E(L(),-1):E(t[_+1],_+1));break;case tX.nx.UP:e.preventDefault(),0===_&&E(L(),-1),_>0&&t&&E(t[_-1],_-1)}},maxHeight:c})})}),children:(0,r.jsx)(tJ,{isAriaExpanded:n,isDropdownVisible:I,value:S,placeholder:o,onChange:O,onSearch:R,onFocus:()=>{w.current=!1,s(!0),x(-1),g(t1.E.SEARCH_PAGE_CLICK_INPUT_BOX,{...null==t?void 0:t.logging,query:m})},onBlur:A,onKeyUp:(e,t)=>{switch(e.keyCode){case tX.nx.TAB:case tX.nx.ESC:A();break;case tX.nx.ENTER:if(!m.length)return;w.current=!0;let n=(0,N.LT)(N.ZP.searchStore,{query:e.currentTarget.value},{event_type:t1.I.SEARCH});if(e.currentTarget.blur(),l){l(m);break}t(n);break;case tX.nx.DOWN:e.preventDefault(),Z();break;case tX.nx.UP:e.preventDefault(),D()}},autoComplete:"off",setIsOpenDropdown:s,...h})})};var t3=n(14327),t9=n(258314);let t2=e=>{let{isOpenDropdown:t,isReadyToOpenDropdown:n,setIsOpenDropdown:a,withRightPadding:s=!1,placeholder:o,initialSearchQuery:l,overrideNavigateOnEnter:d,navigateOnInputBlur:c,additionalQueryVariables:u,searchListMaxHeight:h}=e,{isCollapsed:p,legoDriverParams:v,setLegoDriverParams:g}=(0,tM.AB)(),{deviceTypeString:m}=(0,tT.s)(),{loading:f}=(0,tF.cX)(),{asPath:b,query:y}=(0,tr.tv)(),S=(0,tr.UO)(),C=(0,t9.V)(b,tG._j.legoSearch)||(0,t9.V)(b,tG._j.legoSearchNext),_=y.query,x=C?Array.isArray(_)?_[0]:_||S.query:l||void 0;return i.useEffect(()=>{x&&g(e=>({...e,presetQuery:x}))},[]),(0,r.jsx)(tL.$,{"data-testid":R.m.searchInput,deviceType:m,isCollapsed:p,withRightPadding:s,shouldUseV2:!0,children:f!==tw.pT.Page&&(0,r.jsx)(tI.F,{disableSpinner:!0,debugMode:!1,queryOptions:{fetchPolicy:"no-cache"},productComponent:t3.F.Search,additionalQueryVariables:u,...v,children:e=>{let{data:i}=e;return(0,r.jsx)(t7,{data:i,isOpenDropdown:t,setIsOpenDropdown:a,isReadyToOpenDropdown:n,placeholder:o,overrideNavigateOnEnter:d,navigateOnInputBlur:c,searchListMaxHeight:h,searchQuery:x,size:tk.J9.small})}})})},t8=()=>{let[e,t]=i.useState(!1),{isDoorDash:n}=(0,f.Z)();return(0,r.jsx)(t2,{isReadyToOpenDropdown:!0,isOpenDropdown:e,placeholder:O.ZP.t(n?"layoutStrings_header_searchInput_search_v2":"layoutStrings_header_searchInput_search"),setIsOpenDropdown:t})},ne=()=>{switch((0,e1.qr)(e=>e.pageType)){case tu.G.StorePageSSR:case tu.G.ConvenienceCollectionSSR:case tu.G.ConvenienceCategorySSR:case tu.G.ConvenienceSearchResultsSSR:case tu.G.ConvenienceListSSR:case tu.G.ConvenienceStoreSSR:case tu.G.ConvenienceCollectionsFeedSSR:case tu.G.ConvenienceCursorItemCarouselSSR:case tu.G.OrderGifting:case tu.G.OrderGiftingHelp:return null;case tu.G.LegoHomeSSR:case tu.G.LegoSearchSSR:default:return(0,r.jsx)(t8,{})}};var nt=n(285661),nn=n(27943),nr=n(232945);let ni=()=>{let{shouldShowOpenCarts:e}=(0,nn.G)(),{orderCart:t}=(0,a.re)(),n=null==t?void 0:t.id,r=i.useRef(n),s=(0,nr.AJ)({skip:!e}),o=null==s?void 0:s.refetch;return i.useEffect(()=>{r.current!==n&&n&&(r.current=n,null==o||o())},[n,o]),{openCartsCountRes:s,shouldShowOpenCarts:e}};var na=n(953155),ns=n(695163),no=n(7449),nl=n(442008),nd=n.n(nl),nc=n(979994),nu=n(860413),nh=n(910636),np=n(852670);function nv(){let e=(0,nc._)(["\n  query getBundleSearchResultsAtPreCheckout($cartUuid: ID!, $bundleType: BundleType, $cacheKey: String) {\n    getBundleSearchResultsAtPreCheckout(cartUuid: $cartUuid, bundleType: $bundleType, cacheKey: $cacheKey) {\n      storesList {\n        id\n        businessName\n        coverImageUrl\n        isRetail\n      }\n      displayOptions {\n        preCheckoutHeaderTitles {\n          headerText\n          subheaderText\n          showInfoIcon\n          minimizedStateHeaderText\n        }\n      }\n      legoPage {\n        ...FacetFeedV2ResultFragment\n      }\n    }\n  }\n  ","\n"]);return nv=function(){return e},e}let ng=(0,nu.gql)(nv(),nh._9),nm=()=>(0,np.t)(ng,{fetchPolicy:"cache-first"});var nf=n(48821);let nb=e=>{var t,n,r,i,s;let{cartUuid:o,orderCart:l=null}=e,d=(0,e1.qr)(e=>e.pageType),{isStorefront:c}=(0,f.Z)(),u=nf.wm.includes(d),{orderCart:h}=(0,a.re)(),p=null!=h?h:l,v=null!==(i=null==p?void 0:p.id)&&void 0!==i?i:"",g=null!==(s=null==p?void 0:null===(r=p.orders)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:null===(t=n.orderItems)||void 0===t?void 0:t.length)&&void 0!==s?s:0,m=(null==p?void 0:p.isConsumerPickup)||!1,b=(null==p?void 0:p.groupCart)||!1,y=(0,te.w)(p);return{isPreCheckoutEligible:u&&g>0&&o&&v===o&&!b&&!y&&!m&&!c}};var ny=n(365416);let nS=e=>{var t,n;let{orderCart:r}=e,i=nf.P$,{isPreCheckoutEligible:a}=nb({cartUuid:null!==(t=null==r?void 0:r.id)&&void 0!==t?t:"",orderCart:r}),{scheduledTime:s}=(0,ny.$)({pollingInterval:i,cartUuid:null!==(n=null==r?void 0:r.id)&&void 0!==n?n:""}),[o]=nm();return nd()(()=>{if(a){var e;o({variables:{cartUuid:null!==(e=null==r?void 0:r.id)&&void 0!==e?e:"",cacheKey:s,bundleType:G.v5z.BUNDLE_TYPE_PRE_CHECKOUT_CART}})}},100)},nC=()=>{let[e,t]=i.useState(null),n=(0,tx.n)(),s=(0,eQ.E_)(e=>e.showCartSideBar),{orderCart:o,isLoading:l}=(0,a.re)(),{openCartsCountRes:{data:d,loading:c},shouldShowOpenCarts:u}=ni(),h=null==d?void 0:d.getOpenCartsCount,p=(null==o?void 0:o.orders)||[],v="fixed"===n,g=(0,na.$)(p),m=(0,ns.W)({itemCount:g,loading:c||l,openCartsCount:h,showOpenCarts:u}),f=nS({orderCart:o}),b={"aria-controls":nt.F.ORDER_CART,"aria-haspopup":!0,"data-accessiblity-id":nt.F.ORDER_CART_BUTTON,"data-anchor-id":"HeaderOrderCart","data-testid":nt.T.ORDER_CART_ICON_BUTTON,accessibilityLabel:O.ZP.t("layoutStrings_orderCart_openCartAccessibilityLabel",{numItems:g}),itemCount:g,onClick:()=>{s()}};return i.useEffect(()=>{t({"aria-hidden":v})},[v]),(0,r.jsx)(no.Z,{badgeCount:m,...b,...e,onMouseEnter:f})};var n_=n(347362),nx=n(499676),nP=n(457182),nj=n(761054),nT=n(648806),nk=n(234787),nw=n(166120),nI=n(522978),nL=n(143133),nE=n(862484),nR=n(971174),nO=n(730342);let nN=(0,eD.default)(()=>Promise.all([n.e(57743),n.e(80188),n.e(86751),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(46150),n.e(96227)]).then(n.bind(n,446150)),{loadableGenerated:{webpack:()=>[446150]},ssr:!1}),nA=(0,eD.default)(()=>Promise.all([n.e(57743),n.e(80188),n.e(86751),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(1770)]).then(n.bind(n,780915)),{loadableGenerated:{webpack:()=>[780915]},ssr:!1}),nZ=["getSideNavDynamicTabs"],nD=e=>{var t,n,a,s;let{renderBeforeAddressList:o,consumer:l,shouldShowAddressPicker:d,onAddressChange:c,addressText:u,refetchQueriesOnAddressUpdate:h,refetchQueries:p,isCurrentLocationEnabled:v=!1,isCurrentLocationSelected:g=!1,onClickCurrentLocation:m,shouldShowInfoPickerTooltip:f,shouldUseV2:b=!1}=e,y=null===(n=l.defaultAddress)||void 0===n?void 0:null===(t=n.personalAddressLabel)||void 0===t?void 0:t.labelIcon,S=(0,e8.p)(),[C,_]=i.useState(!1),{isAddressLabelEnabled:x}=(0,nw.Z)(),P=g&&x,T=i.useCallback(e=>{_(!1),null==c||c(e)},[c]),k=()=>{var e;C?T():_(!0),(0,j.j)("m_homepage_tap_default_address",{delivery_address_id:(null==l?void 0:null===(e=l.defaultAddress)||void 0===e?void 0:e.id)||null})},w=(0,nI.R)((null==S?void 0:S.id)||"",T);i.useEffect(()=>{d&&_(!0)},[d]);let I=x&&!(null===(a=l.defaultAddress)||void 0===a?void 0:a.shortname),L=[...h||p||[],...nZ];return x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nR.p,{shouldShowInfoPickerTooltip:f,children:(0,r.jsx)(nE.d_,{children:(0,r.jsx)(nL.Wb,{label:(0,e0.ow)({addressTextProp:u,defaultAddress:l.defaultAddress,isAddressLabelEnabled:x}),accessabilityString:"",aria:"layout-address-picker",hideChevronIcon:I,onClick:k,shouldShowCurrentLocationIcon:P,isAddressLabelEnabled:x||b,hasNoDefaultAddressShortname:!(null===(s=l.defaultAddress)||void 0===s?void 0:s.shortname),addressLabelIcon:(0,nk.a)(y,!0),shouldUseV2:b})})}),C&&(0,r.jsx)(nP.g,{children:(0,r.jsx)(nN,{addressEntryPoint:"Common/Layout/Header/InfoPicker",onChange:w,customizations:{renderAutocompleteSuggestionsInAnchoredLayer:!0,hideAutoCompleteLabel:!0},renderBeforeAddressList:o?()=>o(_):void 0,refetchQueries:L,hasCloseButton:!0,isCurrentLocationEnabled:v,isCurrentLocationSelected:g,onClose:()=>_(!1),onClickCurrentLocation:m})})]}):(0,r.jsx)(nE.Qd,{"data-testid":R.m.infoPicker,noMarginLeft:b,children:(0,r.jsx)(nj.Z,{content:(0,r.jsx)(nO.Z.Provider,{isEnabled:!1,children:(0,r.jsx)(nE.xU,{id:"layout-address-picker",children:(0,r.jsx)(nA,{consumer:l,handlePickerClose:T,refetchQueries:L,renderBeforeAddressList:o?()=>o(_):void 0,isCurrentLocationEnabled:v,isCurrentLocationSelected:g,onClickCurrentLocation:()=>{null==m||m(),_(!1)}})})}),interactionType:nT.p.controlled,isVisible:!!C,onVisibilityChange:e=>{_(e)},position:tR.eW.bottomLeft,children:e=>{var t;let{describedBy:n}=e;return(0,r.jsx)(nR.p,{shouldShowInfoPickerTooltip:f,children:(0,r.jsx)(nL.Wb,{label:(0,e0.ow)({addressTextProp:u,defaultAddress:l.defaultAddress,isAddressLabelEnabled:x}),accessabilityString:null!=n?n:"",aria:"layout-address-picker",hideChevronIcon:!1,onClick:k,shouldShowCurrentLocationIcon:P,isAddressLabelEnabled:x||b,hasNoDefaultAddressShortname:!(null===(t=l.defaultAddress)||void 0===t?void 0:t.shortname),addressLabelIcon:(0,nk.a)(y,!0),shouldUseV2:b})})}})})};var nG=n(74152),nB=n(480704),nM=n(788594),nU=n(911646),nF=n(571734);let nH=(0,eD.default)(()=>Promise.all([n.e(57743),n.e(80188),n.e(86751),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(46150),n.e(96227)]).then(n.bind(n,446150)),{loadableGenerated:{webpack:()=>[446150]},ssr:!1}),nz=(0,eD.default)(()=>Promise.all([n.e(57743),n.e(80188),n.e(86751),n.e(57590),n.e(4024),n.e(77535),n.e(44694),n.e(66544),n.e(33160),n.e(59500),n.e(1770)]).then(n.bind(n,780915)),{loadableGenerated:{webpack:()=>[780915]},ssr:!1}),nV=e=>{var t,n,a,s;let{consumer:o,refetchQueries:l,refetchQueriesOnAddressUpdate:d,addressText:c,onAddressChange:u,isCurrentLocationEnabled:h=!1,isCurrentLocationSelected:p=!1,onClickCurrentLocation:v,shouldShowInfoPickerTooltip:g,onClickAddress:m,placeholder:f}=e,[b,y]=i.useState(!1),{showSignInSignUpModal:S,setShowSignInSignUpModal:C,onIdentityLinkClick:_}=(0,J.Z)(),{isAddressLabelEnabled:x}=(0,nw.Z)(),P=(0,e8.p)(),T=i.useCallback(e=>{y(!1),null==u||u(e)},[u]),k=(0,nI.R)((null==P?void 0:P.id)||"",T);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K.L,{isOpen:S,setShowSignInSignUpModal:C,onClose:()=>C(!1)}),(0,r.jsx)(nF.M,{children:!S&&(0,r.jsxs)(nM.Qd,{noMarginLeft:!o.isGuest,"data-testid":R.m.infoPickerMobile,children:[(0,r.jsx)(nR.p,{shouldShowInfoPickerTooltip:g,children:(0,r.jsx)(nL.ZP,{label:(0,nU.ow)({addressTextProp:c,defaultAddress:o.defaultAddress,isAddressLabelEnabled:x}),accessabilityString:"",aria:"layout-address-picker",hideChevronIcon:x&&!(null===(t=o.defaultAddress)||void 0===t?void 0:t.shortname),onClick:()=>{var e;null==m||m(),y(!0),(0,j.j)("m_homepage_tap_default_address",{delivery_address_id:(null==o?void 0:null===(e=o.defaultAddress)||void 0===e?void 0:e.id)||null})},shouldShowCurrentLocationIcon:p&&x,isAddressLabelEnabled:x,hasNoDefaultAddressShortname:!(null===(n=o.defaultAddress)||void 0===n?void 0:n.shortname),addressLabelIcon:(0,nB.at)(null===(s=o.defaultAddress)||void 0===s?void 0:null===(a=s.personalAddressLabel)||void 0===a?void 0:a.labelIcon,!0)})}),b&&(0,r.jsx)(r.Fragment,{children:x?(0,r.jsx)(nH,{addressEntryPoint:"Common/Layout/Header/InfoPickerMobile",onChange:k,customizations:{renderAutocompleteSuggestionsInAnchoredLayer:!0,hideAutoCompleteLabel:!0},refetchQueries:d||l,hasCloseButton:!0,isCurrentLocationEnabled:h,isCurrentLocationSelected:p,onClose:()=>y(!1),onClickCurrentLocation:v}):(0,r.jsx)(nG.Z,{isOpen:!0,shouldEnableLegacyConditionalRendering:!0,shouldAnimate:!0,title:"",onClose:()=>{T()},isFooterFixedPosition:!0,children:(0,r.jsx)(nz,{consumer:o,handleIdentityLinkClick:_,handlePickerClose:T,refetchQueries:d||l,placeholder:f})})})]})})]})};var nW=n(751313),nQ=n(671844),nY=n(337913),n$=n(786381),nq=n(638672);let nK=()=>{let{pageType:e}=(0,e1.qr)(e=>({pageType:e.pageType})),t=(0,a.pR)(e=>e.enableStorePageDecompExperiment),{storePageFeedVariables:n}=(0,nq.c)(e=>({storePageFeedVariables:e.storePageFeedVariables})),{shouldShowOpenCarts:r}=(0,nn.G)(),i=[];switch(e){case tu.G.LegoHomeSSRTbt:i=[nQ.T,"homePageFacetFeed"];break;case tu.G.LegoSearchSSRTbt:i=[nQ.T,"searchWithFilterFacetFeed"];break;case tu.G.LegoHomeSSR:i=[nQ.T,"homePageFacetFeed"];break;case tu.G.LegoSearchSSR:i=[nQ.T,"searchWithFilterFacetFeed"];break;case tu.G.LegoVerticalHomepageSSR:i=[nQ.T,"verticalPageFacetFeed"];break;case tu.G.LegoItemsSSR:i=[nQ.T,"itemCarouselPageFacetFeed"];break;case tu.G.LegoCollectionSSR:i=[nQ.T,"collectionLandingPageFacetFeed"];break;case tu.G.LegoBrowseSSR:i=[nQ.T,"browsePageFacetFeed"];break;case tu.G.LegoCategoriesSSR:i=[nQ.T,"facetFeed"];break;case tu.G.Tabs:case tu.G.GroceryTab:case tu.G.RetailTab:i=[nQ.T,"retailVerticalPageFeed"];break;case tu.G.StorePageSSR:i=(0,nY.$)(n,t);break;case tu.G.DealsLandingPage:i=["nvLandingPage"];break;default:i=[]}return[...i,...r?[n$.QD]:[]]},nJ=e=>{let{consumer:t,isMobile:n,...i}=e,a=nK();return(0,r.jsx)(n?nV:nD,{shouldUseV2:!n,consumer:t,onAddressChange:e=>{window.dispatchEvent(new CustomEvent("addresschange",{detail:e})),(0,nW.LK)()},refetchQueries:a,...i})};var nX=n(122711),n0=n(349210),n1=n(296319),n4=n(818617),n6=n(230714),n5=n(795348);let n7=e=>{let{className:t,isWide:n,redirectToHome:a=!1,customRedirectUrl:s,entryPoint:o,shouldUseV2:l}=e,{isDoorDash:d,isCaviar:c}=(0,f.Z)(),u=d||c,[h,p]=i.useState([]),v=!!(u&&n&&h.length),g=h[0],m=h[1],{getLoginUrl:b}=(0,$.Yq)(),{redirectBackAfterLogIn:y,redirectUrl:_}=(0,n5.d)({redirectToHome:a,customRedirectUrl:s}),{showLoginInModalExpEnabled:x,showSignInSignUpModal:P,setShowSignInSignUpModal:T,showSignUpView:k,setShowSignUpView:w,onIdentityLinkClick:I}=(0,J.Z)();(0,n0.L)(()=>p([b({redirectBackAfterLogIn:y,nextPath:_}),b({redirectBackAfterLogIn:y,nextPath:_,navigateToSignUp:!0})]),[]);let L=(e,t)=>{x&&(e.preventDefault(),t?(0,j.j)("signin_modal_signup_view"):(0,j.j)("signin_modal_signin_view"),I(),w(t)),(0,n6.b)(o)};if(!v)return null;let E=c?C.d9.action.primary.default:void 0;return(0,r.jsxs)(nE.mf,{"data-testid":R.m.signinSignupButton,className:t,isCaviar:c,shouldUseV2:!!l,children:[(0,r.jsx)(K.L,{isOpen:P,setShowSignInSignUpModal:T,onClose:()=>T(!1),showSignUpView:k}),(0,r.jsx)(n1.C,{isInline:!0,type:tO.L$.flatSecondary,size:l?eB.qE.small:eB.qE.medium,href:g,onClick:e=>L(e,!1),children:(0,r.jsx)(S.x,{textStyle:C.TextStyle.label.small.strong,children:O.ZP.t("landing_signIn")})}),(0,r.jsx)(n1.C,{isInline:!0,"data-testid":n4.Xv.signUpButton,"data-anchor-id":n4.Xv.signUpButton,type:c?tO.L$.flatSecondary:tO.L$.primary,size:eB.qE.medium,href:m,onClick:e=>L(e,!0),children:(0,r.jsx)(S.x,{textStyle:C.TextStyle.label.small.strong,color:E,children:O.ZP.t("landing_signUp")})})]})};var n3=n(222556),n9=n(853307),n2=n(250804),n8=n(325647),re=n(424),rt=n(334647),rn=n(59746),rr=n(658139),ri=n(55648),ra=n(687204);let rs=e=>{let{shouldPoll:t,hasNewNotifications:n,numNewNotifications:r,hasViewedNotifications:i,showNotificationsContainer:a}=e,{showGuestExperience:s}=(0,ra.Q)(),{hasOrderTracker:o,error:l}=(0,rt.K)({shouldPoll:t,shouldUseLazyQuery:!0,shouldSkipQuery:s});l&&(0,rn.hd)({origin:"useGetOrderTrackerDetailsWithPolling",client_error_id:rr.N.Query,component:t3.F.Notifications,error_message:(0,ri.yd)(l),internal_error_message:rr.D.NotificationHubOrderDetailsError,error_type:rr.N.Query});let d=!i&&n,c=!1,u=!1;return o?u=!a&&(d||o):c=!a&&d,{showCountBadge:c,showDotBadge:u,hasOrderTracker:o,numNewNotifications:r}};var ro=n(593529);let rl=(e,t)=>"(".concat(t<10?t:"9+",") ").concat(e),rd=(e,t)=>{let n=(0,i.useRef)(null);i.useEffect(()=>(null===n.current&&document.title&&(n.current=document.title),()=>{null!==n.current&&(document.title=n.current)}),[]),i.useEffect(()=>{if(!(null==n?void 0:n.current))return;let r=n.current;t&&!e&&(r=rl(n.current,t)),(0,ro.pj)({pageTitle:r})},[t,e])};var rc=n(522840),ru=n(607037);let rh=()=>{let{showGuestExperience:e}=(0,ra.Q)(),{hasViewedNotifications:t}=(0,rc.f)(),n=(0,ru.F7)();return!!e&&!n&&!t};var rp=n(86951);let rv=e=>{let{isBellIconSelected:t,onBellIconClick:n,describedBy:a,isBadgeDisabled:s,hasViewedNotifications:o,hasNewNotifications:l,showNotificationsContainer:d,numNewNotifications:c}=e,[u,p]=i.useTransition(),{isMobile:v}=(0,eT.ac)(),{showCountBadge:g,showDotBadge:m,hasOrderTracker:f}=rs({shouldPoll:!t,hasNewNotifications:l,numNewNotifications:c,hasViewedNotifications:o,showNotificationsContainer:d}),b=rh();rd(o,c);let y=(0,t$.xk)(tQ.bW.TOOLBAR_ICON,{entityType:tQ.py.TOOLBAR_ITEM,entityId:rp.uF.NOTIFICATION_HUB},{},{entity:{toolbarItem:{type:rp.uF.NOTIFICATION_HUB,hasActiveBadge:g||m}},customAttrs:{has_active_order:f,action_button:!t}});return(0,r.jsxs)(n9.TO,{role:"button",onClick:()=>{y(),p(()=>{(0,j.j)("notif_hub_entry_point_click",{is_badged:g||m,has_active_order:f,action_button:!t}),null==n||n()})},"data-testid":n4.dM.NotificationBell,children:[(0,r.jsx)(()=>u?(0,r.jsx)(eJ.g,{size:n8.E$.small,color:n8.nm.dark}):(0,r.jsx)(n9.dx,{iconType:t?h.IconType.NotifyFill:h.IconType.NotifyLine,size:eB.rm.small,type:v?void 0:tO.xZ.tertiary,accessibilityLabel:"Notification Bell",accessibilityDescribedBy:a,"data-testid":n4.dM.HeaderNotificationBellIcon}),{}),!s&&(m||b)&&(0,r.jsx)(n9.nb,{}),!s&&g&&c&&(0,r.jsx)(n9.nN,{children:(0,r.jsx)(S.x,{size:C.yH.xxSmall,color:re.i2.SystemWhite,weight:C.fs.bold,children:(0,n2.L)(c)})})]})};var rg=n(571156),rm=n(337542),rf=n(355877),rb=n(349844);let ry=function(){var e;let{shouldSkipQuery:t=!1,enablePolling:n=!1,pollingInterval:r=3e4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[a,s]=i.useState(!1),[o,{loading:l,data:d,error:c,called:u}]=(0,rf.Z)(),{hasNewNotifications:h,numUnreadNotifications:p}=null!==(e=null==d?void 0:d.getHasNewNotifications)&&void 0!==e?e:{},{stopPolling:v}=(0,rb.W)({pollingRequestFn:o,pollingInterval:n?r:null,inactiveTabPollingInterval:4*r,pollWhenTabIsInactive:!0});return i.useEffect(()=>{u||t||o()},[u,o,t]),i.useEffect(()=>{l||(null==h||null==p||c?(v(),s(!1),(0,rn.hd)({origin:"useHasNewNotifications",client_error_id:rr.N.Query,component:t3.F.Notifications,error_message:(0,ri.yd)(c),internal_error_message:rr.D.HasNewNotificationsError,error_type:rr.N.Query})):s(h))},[l,h,p,c,v]),{hasNewNotifications:a,numNewNotifications:p}};var rS=n(670549),rC=n(988433),r_=n(466533),rx=n(262679);let rP="/notifications/service-worker/",rj=e=>{var t,n;let{enabled:r}=e,a=i.useRef(null),[s,o]=i.useState(!1),l=(0,ru.R7)()&&s,[d,c]=i.useState((null===(n=a.current)||void 0===n?void 0:null===(t=n.active)||void 0===t?void 0:t.state)==="activated"),[u,h]=i.useState(null),p=i.useRef(null),{appWebSHa:v}=i.useMemo(rS.B,[rS.B]),g=i.useCallback(e=>{var t;if(null===(t=a.current)||void 0===t?void 0:t.active)try{a.current.active.postMessage(e)}catch(n){let t=Error("Failed to send ".concat(e.type," message to service worker with scope ").concat(rP,": ").concat(n.message));h(t),(0,rx.Tb)(t)}},[]),m=i.useCallback(()=>{g({type:rC.a.INITIALIZE,data:{workerId:v}})},[g,v]),f=i.useCallback(e=>{let t={type:rC.a.KEEP_ALIVE};p.current&&clearInterval(p.current),p.current=e?setInterval(()=>g(t),1e4):null},[g]),b=async()=>(await navigator.serviceWorker.getRegistrations()).find(e=>e.scope==="".concat(window.location.origin).concat(rP)),y=i.useCallback(()=>{var e;let t=null===(e=a.current)||void 0===e?void 0:e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&g({type:rC.a.SKIP_WAITING})})},[g]),S=i.useCallback(()=>{a.current&&m()},[m]),C=i.useCallback(e=>{(null==e?void 0:e.state)==="activated"&&(c(!0),h(null),m())},[m]),_=i.useCallback(e=>{let t=null;return e&&(e.addEventListener("updatefound",y),(t=e.installing||e.waiting||e.active)&&t.addEventListener("statechange",()=>C(t))),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",S),()=>{e&&(e.removeEventListener("updatefound",y),t&&t.removeEventListener("statechange",()=>C(t))),"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("controllerchange",S)}},[y,S,C]),x=i.useCallback(async()=>{var e,t;if(l&&(null===(e=navigator)||void 0===e?void 0:e.serviceWorker))try{let e=await b();if(e)a.current=e,c(!0),_(e);else{let e=await navigator.serviceWorker.register("/notifications/service-worker/index.js",{scope:rP});a.current=e,c((null===(t=e.active)||void 0===t?void 0:t.state)==="activated"),_(e)}h(null)}catch(t){let e=Error("Service worker registration failed: ".concat(t.message));c(!1),h(e),(0,rx.Tb)(e)}},[l,_]),P=i.useCallback(()=>{a.current&&a.current.unregister()},[]);return i.useEffect(()=>{l&&!a.current&&x()},[l,x]),i.useEffect(()=>{r&&d?f(!0):f(!1)},[r,d,f]),i.useEffect(()=>{a.current&&d&&a.current.update()},[d]),i.useEffect(()=>{var e;o((null===(e=window.Notification)||void 0===e?void 0:e.permission)==="granted")},[]),{worker:a.current,unregisterServiceWorker:P,sendMessageToServiceWorker:g,error:u,isReady:d}},rT=async()=>{let e=await (0,r_.t)();if(!(null==e?void 0:e.trackingEvents)||!Object.keys(null==e?void 0:e.trackingEvents).length)return;let t=e.trackingEvents,n={};for(let e in t)if(t.hasOwnProperty(e)&&!t[e].sent){let r=t[e];(0,j.j)(r.name,{timestamp:r.timestamp,type:r.type,...(null==r?void 0:r.payload)?r.payload:{}}),n[e]={...r,sent:!0}}return n};var rk=n(113695),rw=n(944197);let rI=()=>{let{hasViewedNotifications:e,setHasViewedNotifications:t,showNotificationsContainer:n,setShowNotificationsContainer:r}=(0,rc.f)(),{showGuestExperience:a,guestNotifications:s,setGuestNotifications:o}=(0,ra.Q)(),{numNewNotifications:l,hasNewNotifications:d}=ry({shouldSkipQuery:a,enablePolling:!0,pollingInterval:3e4}),[c,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(0),[v,g]=(0,i.useState)(!1),{showCountBadge:m,showDotBadge:f,hasOrderTracker:b}=rs({hasNewNotifications:d,numNewNotifications:l,hasViewedNotifications:e,showNotificationsContainer:n,shouldPoll:!1}),{markAsReadCallback:y}=(0,rg.C)([]),[S,C]=i.useState(!1),{isReady:_,sendMessageToServiceWorker:x}=rj({enabled:(0,ru.R7)()&&S}),{search:P}=(0,tr.TH)(),T=i.useMemo(()=>new URLSearchParams(P),[P]),k=()=>{s.length&&(o(s.map(e=>({...e,read:!0}))),window.localStorage.setItem(ru.mG,"true"))},w=async()=>{var e,t;if(a){k();return}if(null==c?void 0:null===(t=c.body)||void 0===t?void 0:null===(e=t[0].body)||void 0===e?void 0:e.filter(e=>!e.custom.read_state).length)try{await y(),p(0),g(!0)}catch(e){p(e=>e+1),g(!1),h<3?E.callback():(0,rn.hd)({origin:"useMarkAsReadMutation",client_error_id:rr.N.Mutation,component:t3.F.Notifications,error_message:(0,ri.yd)(e),internal_error_message:rr.D.UpdateNotificationReadStatusError,error_type:rr.N.Mutation})}},I=(0,t$.xQ)(tQ.bW.TOOLBAR_ICON,{entityType:tQ.py.TOOLBAR_ITEM,entityId:tQ.bW.TOOLBAR_ICON},{},{entity:{toolbarItem:{type:rp.uF.NOTIFICATION_HUB,hasActiveBadge:m||f}},customAttrs:{has_active_order:b}}),L=(0,rm.Z)(()=>{I(),(0,j.j)("notif_hub_entry_point_view",{is_badged:m||f,has_active_order:b})},1e3);i.useEffect(()=>{var e;C((null===(e=window.Notification)||void 0===e?void 0:e.permission)==="granted")},[]),i.useEffect(()=>("true"===T.get(rw.w1)&&r(!0),()=>{"true"===T.get(rw.w1)&&(0,rk.rg)("showNotificationHub")}),[T,P,r]),i.useEffect(()=>{let e=async()=>{let e=await rT();e&&Object.keys(e).length&&x({type:rC.a.MARK_TRACKING_EVENTS_AS_SENT,data:e})};_&&e()},[_,x]),i.useEffect(()=>(L.callback(),window.addEventListener("beforeunload",O),()=>{window.removeEventListener("beforeunload",O)}),[]);let E=(0,rm.Z)(w,1e3,{leading:!0}),R=(0,i.useCallback)(()=>{r(!0),t(!0)},[t,r]),O=(0,i.useCallback)(()=>{r(!1),t(n),v||E.callback(),"true"===T.get("showNotificationHub")&&(0,rk.rg)("showNotificationHub")},[n,r,v,E,T,t]);return i.useMemo(()=>({onOpenNotificationHubHandler:R,onCloseNotificationHubHandler:O,hasViewedNotifications:e,hasNewNotifications:d,numNewNotifications:l,setNotifications:u}),[e,O,R,d,l,u])};var rL=n(183131),rE=n(783657),rR=n(433048);let rO=(0,eD.default)(()=>Promise.all([n.e(633),n.e(71017)]).then(n.bind(n,71017)),{loadableGenerated:{webpack:()=>[71017]},ssr:!1}),rN={id:"notifications-hub"},rA=e=>{let{}=e,{onOpenNotificationHubHandler:t,onCloseNotificationHubHandler:n,hasViewedNotifications:a,numNewNotifications:s,hasNewNotifications:o,setNotifications:l}=rI(),{showNotificationsContainer:d}=(0,rc.f)(),{showGuestExperience:c}=(0,ra.Q)(),{isMobile:u}=(0,eT.ac)(),h=(0,tz.Gg)()&&!c,[p,v]=i.useState(!1),g=(0,ru.R7)()&&p,{isReady:m,sendMessageToServiceWorker:f}=rj({enabled:g}),b=(0,rE.usePathname)(),y=(0,rE.useSearchParams)();return(i.useEffect(()=>{var e;v((null===(e=window.Notification)||void 0===e?void 0:e.permission)==="granted")},[]),i.useEffect(()=>{n()},[b,y]),i.useEffect(()=>{let e=async()=>{let e=await rT();e&&Object.keys(e).length&&f({type:rC.a.MARK_TRACKING_EVENTS_AS_SENT,data:e})};m&&e()},[g,m,f]),u)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rv,{isBellIconSelected:d,onBellIconClick:t,describedBy:"",hasViewedNotifications:a,hasNewNotifications:o,numNewNotifications:s,showNotificationsContainer:d}),(0,r.jsx)(nG.Z,{isOpen:d,title:"","data-testid":"NotificationsModal",onClose:n,isFullScreenOnMobile:!0,hasContentPadding:!1,hasHeaderPadding:!0,children:(0,r.jsx)(rO,{setNotifications:l,browseButtonClickHandler:n})})]}):h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rv,{isBellIconSelected:d,onBellIconClick:t,describedBy:"",hasViewedNotifications:a,hasNewNotifications:o,numNewNotifications:s,showNotificationsContainer:d}),(0,r.jsx)(rR.R,{isOpen:d,onClose:n,children:(0,r.jsx)(rO,{setNotifications:l,browseButtonClickHandler:n})})]}):(0,r.jsx)(nj.Z,{...rN,"data-testid":rL.D.Popover,content:(0,r.jsx)(rO,{setNotifications:l}),isVisible:d,onClose:n,position:tR.eW.bottomRight,children:e=>{let{describedBy:n}=e;return(0,r.jsx)(rv,{isBellIconSelected:d,onBellIconClick:t,describedBy:n,hasViewedNotifications:a,hasNewNotifications:o,numNewNotifications:s,showNotificationsContainer:d})}})},rZ=()=>{let e=(0,ru.iL)(),t=(0,ru.WR)(),{setShowGuestExperience:n}=(0,ra.Q)(),{isDoorDash:a}=(0,f.Z)();return(i.useEffect(()=>{t&&n(!0)},[t,n]),(e||t)&&a)?(0,r.jsx)(rA,{}):null};var rD=n(107760),rG=n(777656);let rB=new Set([tu.G.StorePageSSR,tu.G.ConvenienceStoreSSR,tu.G.ConvenienceListSSR,tu.G.ConvenienceSearchResultsSSR,tu.G.ConvenienceCategorySSR,tu.G.ConvenienceCollectionSSR,tu.G.ConvenienceCollectionsFeedSSR,tu.G.ConvenienceCursorItemCarouselSSR,tu.G.OrderGifting,tu.G.OrderGiftingHelp]),rM=()=>{let e=(0,rG.y)(),{isSideNavPresentingOnLeft:t}=(0,s.D)(),{consumer:n}=(0,E.R)(),i=n.isGuest,a=(0,e1.qr)(e=>e.isMobileServerSide),o=(0,e1.qr)(e=>e.pageType),l=!rB.has(o),d=(0,eQ.E_)(e=>e.cartPopoverVisible);return(0,r.jsx)(nx.W2,{children:(0,r.jsxs)(nx.p1,{children:[(0,r.jsx)(n_.Z,{isMobileServerSide:a,isSideNavPresentingOnLeft:t,isSideNavCompact:e}),(0,r.jsxs)(nx.Qq,{children:[(0,r.jsx)(nx.zw,{children:(0,r.jsx)(nx.iJ,{children:(0,r.jsx)(ne,{})})}),(0,r.jsxs)(nx.F$,{children:[(0,r.jsx)(nJ,{consumer:n}),l&&(0,r.jsx)(rD.Z,{}),(0,r.jsx)(rZ,{}),(0,r.jsx)(nj.Z,{content:(0,r.jsx)("div",{id:nX.g}),isVisible:d,children:e=>{let{describedBy:t,accessibilityAttributes:n}=e;return(0,r.jsx)(nC,{...n,"aria-describedby":t})}}),i&&(0,r.jsx)(n7,{isWide:!0,shouldUseV2:!0,entryPoint:n3.N.APP})]})]})]})})},rU=()=>(0,r.jsx)(rM,{});var rF=n(902093),rH=n(37174),rz=n(22649),rV=n(119455),rW=n(878310),rQ=n(433073),rY=n(419800),r$=n(281823),rq=n(809322);let rK=e=>{let{isOpenDropdown:t,setIsOpenDropdown:n,hasTopSpacing:i=!0}=e;return(0,r.jsx)(rq.SE,{hasTopSpacing:i,children:(0,r.jsx)(r$.E,{autoFocus:!0,children:(0,r.jsx)(t2,{isOpenDropdown:t,isReadyToOpenDropdown:!0,setIsOpenDropdown:n})})})};var rJ=n(321564);let rX=e=>{let{entry:t,btnType:n,btnText:a}=e,{identityUrl:s,showSignInSignUpModal:o,setShowSignInSignUpModal:l,handleSignInButtonClick:d}=(0,rJ.u)(t,n6.b),{isDoorDash:c,isCaviar:u}=(0,f.Z)();return s&&(c||u)?(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(K.L,{isOpen:o,setShowSignInSignUpModal:l,onClose:()=>l(!1),showSignUpView:!1}),(0,r.jsx)(n1.Z,{isInline:!0,type:n,size:eB.qE.medium,href:s,onClick:e=>d(e),children:a})]}):null};var r0=n(37661),r1=n(168792),r4=n(410682),r6=n(357166);let r5=(0,eD.default)(()=>n.e(32892).then(n.bind(n,246073)),{loadableGenerated:{webpack:()=>[246073]},ssr:!1}),r7=(0,eD.default)(()=>n.e(55266).then(n.bind(n,855266)),{loadableGenerated:{webpack:()=>[855266]},ssr:!1}),r3=()=>{let{consumer:e}=(0,E.R)(),t=e.isGuest,[n,a]=i.useState(!1),{showSmartAppBanner:s}=(0,r1.G)(),{showAppBanner:o}=(0,r4.M)(),l=()=>{a(!n)},d=(0,r6.Ui)();return(0,r.jsxs)(nx.W2,{isMobile:!0,showSmartAppBanner:s,showAppBanner:o,children:[(0,r.jsx)(nx.j5,{showSmartAppBanner:s,children:s?(0,r.jsx)(r5,{}):null}),(0,r.jsxs)(nx.p1,{isMobile:!0,showSmartAppBanner:s,showAppBanner:o,children:[(0,r.jsxs)(nx.z9,{$height:rQ.qx.HEADER_MOBILE_TOP,children:[(0,r.jsx)(r0.Z,{isSideNavCompact:!0,onClick:l}),d&&(0,r.jsx)(nx.VL,{children:(0,r.jsx)(nJ,{consumer:e,isMobile:!0})}),(0,r.jsxs)(rF.Z,{size:eU.O8.xxxSmall,children:[t&&(0,r.jsx)(rX,{entry:n3.N.APP,btnType:tO.L$.flatSecondary,btnText:O.ZP.t("new_user_mobile_header_login")}),(0,r.jsx)(rV.h,{entryPoint:n3.N.APP})]})]}),(0,r.jsx)(y.Z,{type:rH.C.fullBorder}),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(r7,{}),(0,r.jsx)(y.Z,{type:rH.C.fullBorder})]}),(0,r.jsxs)(nx.z9,{$height:rQ.qx.HEADER_MOBILE_TOOLBAR,children:[!d&&(0,r.jsx)(nx.VL,{children:(0,r.jsx)(nJ,{consumer:e,isMobile:!0})}),(0,r.jsxs)(rF.Z,{alignItems:rz.v2.center,children:[d&&(0,r.jsx)(nx.R$,{isExpanded:n,children:(0,r.jsx)(t2,{isOpenDropdown:n,isReadyToOpenDropdown:!0,setIsOpenDropdown:a,placeholder:O.ZP.t("layoutStrings_header_searchInput_search_v2")})}),!d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rY.Z,{onClick:l}),n&&(0,r.jsx)(rK,{isOpenDropdown:n,setIsOpenDropdown:a,hasTopSpacing:!0})]}),(!d||!n)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rW.Z,{}),(0,r.jsx)(rZ,{}),(0,r.jsx)(nC,{})]})]})]})]})]})},r9=()=>(0,r.jsx)(r3,{});var r2=n(604802);let r8=()=>"mobile"===(0,r2.j)()?(0,r.jsx)(r9,{}):(0,r.jsx)(rU,{});var ie=n(665709);let it=e=>{let{children:t}=e,n=(0,tx.n)(),i=(0,rG.y)(),{isSideNavPresentingOnLeft:a}=(0,s.D)();return(0,r.jsx)(ie.V,{isCartFixed:"fixed"===n,isSideNavPresentingOnLeft:a,isSideNavCompact:i,children:t})},ir=()=>{let{isSideNavCompact:e,isSideNavPresentingOnLeft:t}=(0,s.D)();return t?(0,r.jsx)(eE,{isCompact:e}):(0,r.jsx)(eR.c,{})},ii=e=>{let{children:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ir,{}),(0,r.jsx)(r8,{}),(0,r.jsx)(tj,{}),(0,r.jsx)(it,{children:t})]})},ia=i.memo(function(e){let{children:t,isNonCommonLayoutPageType:n,persistentCartStoreProps:i}=e;return n?t:(0,r.jsx)(a.TO,{...i,children:(0,r.jsx)(ii,{children:t})})}),is=e=>{let{children:t,persistentCartStoreProps:n}=e,i=(0,e1.qr)(e=>e.pageType),a=i===tu.G.Unknown||i===tu.G.DoorDashHomeSSRTbt;return(0,r.jsx)(ia,{isNonCommonLayoutPageType:a,persistentCartStoreProps:n,children:t})}}},function(e){e.O(0,[11770,13443,88577,21966,13956,48621,3867,40041,50891,44321,62465,72781,86023,60288,77918,69646,75395,81394,55618,13971,82736,57463,58325,36116,3046,87542,16108,28683,87667,30872,59238,7055,51762,37640,84497,88505,2297,5017,74152,99357,19613,12907,48534,59659,8655,48284,97853,56512,20437,23887,22634,90892,69460,78361,57411,8309,69353,62961,94633,8665,11895,12996,10807,6987,52675,3904,20612,82874,48516,62660,21324,71367,48740,98834,44417,1744],function(){return e(e.s=967756)}),_N_E=e.O()}]);
//# sourceMappingURL=layout-b16a6fb81d252a3c.js.map
//# debugId=2ba8d16b-b325-51d3-86b4-4a4e41e022a8
