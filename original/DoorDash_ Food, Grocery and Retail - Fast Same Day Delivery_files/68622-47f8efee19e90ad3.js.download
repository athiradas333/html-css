
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0f4db951-3330-58b7-84c5-4d073b4a8a02")}catch(e){}}();
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="dda2b0f4-41a0-44b1-b027-af0331a2160f",e._sentryDebugIdIdentifier="sentry-dbid-dda2b0f4-41a0-44b1-b027-af0331a2160f")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[68622],{968622:function(e,n,t){t.d(n,{wA:function(){return n9},_0:function(){return E},vJ:function(){return y},w:function(){return m},WP:function(){return eP},nq:function(){return ez},Aq:function(){return nY},tq:function(){return tt},MK:function(){return nQ},nu:function(){return O},Ee:function(){return tr},M4:function(){return n8},BY:function(){return ta},bQ:function(){return n$},aH:function(){return ts}});var o,r,i,s,a,u,c,l,d,f,p,g,h,v,m,y,E,_,w,I,b,N,A,T,C,S,R,O=function(e){return null!=e},D=t(641760),x=t(67250);(o=h||(h={})).Generic="generic",o.UIEffect="mosaic.ui_effect",o.ResultBased="result_based",(r=v||(v={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",r.TYPE_ENABLED="TYPE_ENABLED",r.TYPE_VISIBILITY="TYPE_VISIBILITY",r.TYPE_BACKGROUND_COLOR="TYPE_BACKGROUND_COLOR",r.TYPE_BORDER="TYPE_BORDER",r.TYPE_PADDING="TYPE_PADDING",r.TYPE_SHADOW="TYPE_SHADOW",r.TYPE_FRAME="TYPE_FRAME";var M=x.z.object({type:x.z.literal(v.TYPE_VISIBILITY),value:x.z.object({primitive_value:x.z.object({bool_value:x.z.boolean()})})}),z=x.z.object({type:x.z.literal(v.TYPE_ENABLED),value:x.z.object({primitive_value:x.z.object({bool_value:x.z.boolean()})})}),P=x.z.object({padding:x.z.object({top:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),leading:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),trailing:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),bottom:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0})})}),B=x.z.object({type:x.z.literal(v.TYPE_PADDING),value:P}),U=x.z.object({border:x.z.object({width:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),radius:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),color:x.z.object({value:x.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0})})}),L=x.z.object({type:x.z.literal(v.TYPE_BORDER),value:U}),k=x.z.object({shadow:x.z.object({value:x.z.string().min(1)})}),j=x.z.object({type:x.z.literal(v.TYPE_SHADOW),value:k}),V=x.z.object({color:x.z.object({value:x.z.string().min(1)})}),G=x.z.object({type:x.z.literal(v.TYPE_BACKGROUND_COLOR),value:V}),Y=x.z.object({frame:x.z.object({width:x.z.object({value:x.z.string().nullish().transform(function(e){return null!=e?e:void 0}),absolute:x.z.number().nullish().transform(function(e){return null!=e?e:void 0})}).nullish().transform(function(e){return null!=e?e:void 0}),height:x.z.object({value:x.z.string().nullish().transform(function(e){return null!=e?e:void 0}),absolute:x.z.number().nullish().transform(function(e){return null!=e?e:void 0})}).nullish().transform(function(e){return null!=e?e:void 0})})}),F=x.z.object({type:x.z.literal(v.TYPE_FRAME),value:Y}),K=x.z.discriminatedUnion("type",[B,L,j,G,M,z,F]),q=x.z.object({key:x.z.string().min(1),property:K}),W=x.z.object({_action_type:x.z.literal(h.UIEffect),action_type:x.z.literal(h.UIEffect),content:q,lego_id:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),Q=W.omit({lego_id:!0,lego_type:!0}).merge(x.z.object({action_id:x.z.string().min(1)})),H=x.z.object({action_type:x.z.string().min(1),content:x.z.record(x.z.any())}),J=x.z.object({primary_action:H,on_success:x.z.array(H).nullish().transform(function(e){return null!=e?e:[]}),on_failure:x.z.array(H).nullish().transform(function(e){return null!=e?e:[]})}),X=x.z.object({_action_type:x.z.literal(h.ResultBased),action_type:x.z.literal(h.ResultBased),content:J,lego_id:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),$=X.omit({lego_id:!0,lego_type:!0}).merge(x.z.object({action_id:x.z.string().min(1)})),Z=x.z.record(x.z.any()),ee=x.z.object({_action_type:x.z.literal(h.Generic),action_type:x.z.string().min(1),content:Z.nullish().transform(function(e){return null!=e?e:{}}),lego_id:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:x.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),en=ee.omit({lego_id:!0,lego_type:!0}).merge(x.z.object({action_id:x.z.string().min(1)})),et=x.z.preprocess(function(e){return(e.actionType&&(e.action_type=e.actionType),e.actionContent&&(e.content=e.actionContent),"mosaic.ui_effect"===e.action_type)?(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.UIEffect}):"result_based"===e.action_type?(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.ResultBased}):(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.Generic})},x.z.discriminatedUnion("_action_type",[W,X,ee])),eo=x.z.preprocess(function(e){return"mosaic.ui_effect"===e.action_type?(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.UIEffect}):"result_based"===e.action_type?(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.ResultBased}):(0,D.__assign)((0,D.__assign)({},e),{_action_type:h.Generic})},x.z.discriminatedUnion("_action_type",[Q,$,en])),er=x.z.object({event_name:x.z.string().min(1),action_id:x.z.string().min(1)});(i=m||(m={})).Component="component",i.Action="action",i.Mosaic="mosaic",i.SessionStore="session-store",i.Custom="custom",(s=y||(y={})).OnClick="on_click",s.OnSuccess="on_success",s.OnInit="on_init",s.OnChange="on_change",s.Custom="custom",(a=E||(E={})).generic="GENERIC",a.state="KEY_STATE_UNSPECIFIED",a.stateComplex="KEY_STATE_COMPLEX",a.uiEffect="MOSAIC_UI_EFFECT",a.selectionSingle="SELECTION_SINGLE";var ei=x.z.object({key:x.z.string().min(1)}),es=x.z.object({_type:x.z.literal(E.state),type:x.z.literal(E.state),value:ei}),ea=x.z.record(x.z.string()),eu=x.z.object({_type:x.z.literal(E.stateComplex),type:x.z.literal(E.state),value:ea}),ec=x.z.object({key:x.z.string().min(1)}),el=x.z.object({_type:x.z.literal(E.uiEffect),type:x.z.literal(E.uiEffect),value:ec}),ed=x.z.object({key:x.z.string().min(1),options:x.z.array(x.z.string().min(1))}),ef=x.z.object({_type:x.z.literal(E.selectionSingle),type:x.z.literal(E.selectionSingle),value:ed}),ep=x.z.record(x.z.unknown()),eg=x.z.object({_type:x.z.literal(E.generic),type:x.z.string().min(1),value:ep}),eh=x.z.preprocess(function(e){return(e.type||(e.type=E.state),e.type===E.state)?e.value.key?(0,D.__assign)((0,D.__assign)({},e),{_type:E.state}):(0,D.__assign)((0,D.__assign)({},e),{_type:E.stateComplex}):e.type===E.uiEffect?(0,D.__assign)((0,D.__assign)({},e),{_type:E.uiEffect}):e.type===E.selectionSingle?(0,D.__assign)((0,D.__assign)({},e),{_type:E.selectionSingle}):(0,D.__assign)((0,D.__assign)({},e),{_type:E.generic})},x.z.discriminatedUnion("_type",[es,eu,el,ef,eg])),ev=x.z.object({key:x.z.string().min(1),value:x.z.string(),should_pass_down:x.z.boolean().nullish().transform(function(e){return null!=e&&e})}),em=x.z.object({attributes:x.z.array(ev).nullish().transform(function(e){return null!=e?e:[]})});(u=_||(_={})).REQUIRED="REQUIRED",u.OPTIONAL="OPTIONAL",u.DEGRADABLE_REQUIRED="DEGRADABLE_REQUIRED",u.DEGRADABLE_OPTIONAL="DEGRADABLE_OPTIONAL";var ey=x.z.preprocess(function(e){return"string"==typeof e.content&&(e.content=JSON.parse(e.content)),e.component_id&&(e.lego_id=e.component_id),e.component_type&&(e.lego_type=e.component_type),e},x.z.object({lego_id:x.z.string().min(1),lego_type:x.z.string().min(1),component_id:x.z.string().min(1).nullish(),component_type:x.z.string().min(1).nullish(),content:x.z.object({actions:x.z.array(et).nullish().transform(function(e){return null!=e?e:[]})}).passthrough().catchall(x.z.any()).nullish().transform(function(e){return null!=e?e:{actions:[]}}),actions:x.z.array(et).nullish().transform(function(e){return null!=e?e:[]}),children:x.z.array(x.z.string().min(1)).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0}),failure_mode:x.z.nativeEnum(_).nullish().transform(function(e){return null!=e?e:_.REQUIRED}),extensions:x.z.array(eh).nullish().transform(function(e){return null!=e?e:[]})}).transform(function(e){return(0,D.__assign)((0,D.__assign)({},e),{content:(0,D.__assign)((0,D.__assign)({},e.content),{actions:e.content.actions.map(function(n){return(0,D.__assign)((0,D.__assign)({},n),{lego_id:e.lego_id,lego_type:e.lego_type})})}),actions:e.actions.map(function(n){return(0,D.__assign)((0,D.__assign)({},n),{lego_id:e.lego_id,lego_type:e.lego_type})})})})),eE=x.z.object({section_id:x.z.string(),content:x.z.array(x.z.string().min(1)).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(x.z.any()),e_=x.z.preprocess(function(e){return e.children&&(e.sections=[{section_id:"".concat(e.group_name,"-section"),content:e.children}]),e},x.z.object({group_name:x.z.string(),sections:x.z.array(eE).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(x.z.any())),ew=x.z.preprocess(function(e){return e.components&&(e.data=e.components),e},x.z.object({page_name:x.z.string().optional(),metadata:x.z.string().nullish().transform(function(e){return null!=e?e:void 0}),groups:x.z.array(e_),data:x.z.array(ey).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0}),actions:x.z.array(eo).nullish().transform(function(e){return null!=e?e:void 0}),action_triggers:x.z.array(er).nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(x.z.any())),eI=t(313773);(c=w||(w={})).SDKRuntimeError="SDKRuntimeError",c.ResponseDownloadError="ResponseDownloadError",c.ResponseParseError="ResponseParseError",c.ResponseRenderError="ResponseRenderError",c.ComponentNotRegistered="ComponentNotRegistered",c.RequiredViewException="RequiredViewException",c.OptionalViewException="OptionalViewException",c.DegradableRequiredViewException="DegradableRequiredViewException",c.DegradableOptionalViewException="DegradableOptionalViewException",c.ActionNotRegistered="ActionNotRegistered",c.ActionExecutionException="ActionExecutionException",c.UIEffectException="UIEffectException";var eb=function(e){function n(t,o){var r=e.call(this,"[mosaic] ".concat(t,", reason=").concat(o.category,", cause=").concat(o.cause instanceof Error?o.cause.message:"none",", data=").concat(o.data?o.data:"none"),{cause:o.cause})||this;return r.logged=!1,r.isBoundaryError=!1,Object.setPrototypeOf(r,n.prototype),r.category=o.category,r.data=o.data,r._cause=o.cause,r}return(0,D.__extends)(n,e),n}(Error),eN=function(e){function n(t){var o=e.call(this,"component error: legoId=".concat(t.legoId,", legoType=").concat(t.legoType,", componentId=").concat(t.componentId,", componentType=").concat(t.componentType,", failureMode=").concat(t.failureMode),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.legoId=t.legoId,o.legoType=t.legoType,o.componentId=t.componentId,o.componentType=t.componentType,o.failureMode=t.failureMode,o}return(0,D.__extends)(n,e),n}(eb),eA=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{category:w.ComponentNotRegistered}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eN),eT=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{failureMode:_.REQUIRED,category:w.RequiredViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eN),eC=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{failureMode:_.OPTIONAL,category:w.OptionalViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eN),eS=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{failureMode:_.DEGRADABLE_REQUIRED,category:w.DegradableRequiredViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eN),eR=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{failureMode:_.DEGRADABLE_OPTIONAL,category:w.DegradableOptionalViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eN),eO=function(e){function n(t){var o=e.call(this,"action error: action_type=".concat(t.action_type,", legoId=").concat(t.legoId,", legoType=").concat(t.legoType,", eventName=").concat(t.eventName,", pageName=").concat(t.pageName,", actionId=").concat(t.actionId,", sessionId=").concat(t.sessionId),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.action_type=t.action_type,o.legoId=t.legoId,o.legoType=t.legoType,o.eventName=t.eventName,o.pageName=t.pageName,o.actionId=t.actionId,o.sessionId=t.sessionId,o}return(0,D.__extends)(n,e),n}(eb),eD=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{category:w.ActionNotRegistered}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eO),ex=function(e){function n(t){var o=e.call(this,(0,D.__assign)((0,D.__assign)({},t),{category:w.ActionExecutionException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,D.__extends)(n,e),n}(eO),eM=function(e){function n(t,o){var r=e.call(this,(0,D.__assign)((0,D.__assign)({},o),{message:t,category:w.UIEffectException}))||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,D.__extends)(n,e),n}(function(e){function n(t){var o=e.call(this,"UI effect error: key=".concat(t.key,", type=").concat(t.type,", ").concat(t.message),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.key=t.key,o.type=t.type,o}return(0,D.__extends)(n,e),n}(eb)),ez={SDKRuntimeError:function(e){function n(t,o){var r=e.call(this,t,{category:w.SDKRuntimeError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,D.__extends)(n,e),n}(eb),Response:{DownloadError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseDownloadError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,D.__extends)(n,e),n}(eb),ParseError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseParseError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,D.__extends)(n,e),n}(eb),RenderError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseRenderError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,D.__extends)(n,e),n}(eb)},Component:{NotRegistered:eA,RequiredException:eT,OptionalException:eC,DegradableRequiredException:eS,DegradableOptionalException:eR},Action:{NotRegistered:eD,ExecutionException:ex},UIEffect:{Exception:eM},ThrowErrorComponent:function(e){var n=e.error;return eI.useEffect(function(){throw n},[n]),null}},eP=function(){function e(e){this.year=e.year,this.month=e.month,this.day=e.day;var n,t,o,r=new Date().getFullYear(),i=new Date().getMonth(),s=new Date().getDate()-1;this.date=new Date(null!==(n=e.year)&&void 0!==n?n:r,null!==(t=e.month)&&void 0!==t?t:i,null!==(o=e.day)&&void 0!==o?o:s)}return e.fromJSON=function(n){if(n){var t=n.year,o=n.month,r=n.day;if("number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new ez.Response.ParseError("Invalid date json",{data:n});return new e({year:0===t?void 0:t,month:0===o?void 0:o-1,day:0===r?void 0:r-1})}},e}(),eB=function(){function e(){}return e.NULL=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.BOOLEAN=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.INT=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.DOUBLE=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.CHAR=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.STRING=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.REGEX=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.DATE=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,D.__extends)(n,e),n}(e)),e.ARRAY=function(e){function n(n){var t=e.call(this)||this;return t.elementType=n,t}return(0,D.__extends)(n,e),n}(e),e}(),eU=function(e){this.value=e,this.type=eB.BOOLEAN},eL=function(e){this.value=e,this.type=eB.INT},ek=function(e){this.value=e,this.type=eB.DOUBLE},ej=function(e){this.value=e,this.type=eB.CHAR},eV=function(e){this.value=e,this.type=eB.STRING},eG=function(e){this.value=e,this.type=eB.REGEX},eY=function(e){this.value=e,this.type=eB.DATE},eF=function(){this.type=eB.NULL,this.value=null},eK=function(e){this.type=e},eq=function(e){this.type=e},eW=function(e){this.values=e,this.type=new eB.ARRAY(eB.INT)},eQ=function(e){this.values=e,this.type=new eB.ARRAY(eB.DOUBLE)},eH=function(e){this.values=e,this.type=new eB.ARRAY(eB.BOOLEAN)},eJ=function(e){this.values=e,this.type=new eB.ARRAY(eB.STRING)},eX=function(e){this.values=e,this.type=new eB.ARRAY(eB.CHAR)},e$=function(e){this.values=e,this.type=new eB.ARRAY(eB.DATE)},eZ=function(){function e(){}return e.getTypeFromAbbreviation=function(e){var n;return null!==(n=this.TYPE_MAP[e])&&void 0!==n?n:null},e.TYPE_MAP={B:eB.BOOLEAN,I:eB.INT,D:eB.DOUBLE,C:eB.CHAR,S:eB.STRING,DT:eB.DATE},e}(),e0=function(){function e(e){this.millisFromEpoch=e}return e.prototype.compareTo=function(e){return this.millisFromEpoch-e.millisFromEpoch},e.prototype.toString=function(){return this.millisFromEpoch.toString()},e.prototype.equals=function(n){if(this===n)return!0;var t=n instanceof e?n:"number"==typeof n&&Number.isInteger(n)?new e(n):null;return null!==t&&this.millisFromEpoch===t.millisFromEpoch},e.prototype.hashCode=function(){return this.millisFromEpoch},e.fromIsoString=function(n){try{var t=new globalThis.Date(n);return new e(t.getTime())}catch(e){throw Error("Invalid ISO8601 format: ".concat(n,". Expected formats: yyyy-MM-ddTHH:mm:ss.SSSZ"))}},e}(),e1={NUMBER:/^-?\d+(\.\d+)?$/,DATE:/^date:(.+)$/},e2={n:"\n",t:"	",r:"\r",b:"\b","\\":"\\","'":"'"},e4=function(){function e(){}return e.parsePrimitiveValue=function(e){switch(e){case"true":return new eU(!0);case"false":return new eU(!1);case"null":return new eF}var n=e.length;if(0===n)return null;if(e1.NUMBER.test(e))return e.includes(".")?new ek(parseFloat(e)):new eL(parseInt(e,10));if(n<2)return null;var t=e[0],o=e[n-1];if('"'===t&&'"'===o)return new eV(e.slice(1,-1));if("'"===t&&"'"===o)return this.parseChar(e);var r=e.match(e1.DATE);return r?this.parseDate(r[1]):null},e.parseDate=function(e){try{return new eY(new e0(parseInt(e,10)))}catch(e){return null}},e.parseChar=function(e){var n,t=e.length;if(3===t)return new ej(e[1]);if(4===t&&"\\"===e[1])return new ej(null!==(n=e2[e[2]])&&void 0!==n?n:e[2]);throw Error("Invalid character literal: ".concat(e))},e}(),e3=function(e){this.key=e,this.type=eB.BOOLEAN},e6=function(e){this.key=e,this.type=eB.INT},e7=function(e){this.key=e,this.type=eB.DOUBLE},e8=function(e){this.key=e,this.type=eB.CHAR},e9=function(e){this.key=e,this.type=eB.STRING},e5=function(e){this.key=e,this.type=eB.DATE},ne=function(e){this.key=e,this.type=new eB.ARRAY(eB.BOOLEAN)},nn=function(e){this.key=e,this.type=new eB.ARRAY(eB.INT)},nt=function(e){this.key=e,this.type=new eB.ARRAY(eB.DOUBLE)},no=function(e){this.key=e,this.type=new eB.ARRAY(eB.CHAR)},nr=function(e){this.key=e,this.type=new eB.ARRAY(eB.STRING)},ni=function(e){this.key=e,this.type=new eB.ARRAY(eB.DATE)},ns=function(e,n){if(this.array=e,this.index=n,e.type instanceof eB.ARRAY)this.type=e.type.elementType;else throw Error("Expected array type for element access, got ".concat(e.type))},na=function(e){this.source=e,this.type=eB.DOUBLE},nu=function(e){this.source=e,this.type=eB.INT},nc=function(e){this.source=e,this.type=eB.STRING},nl=function(e){this.source=e,this.type=eB.DATE};(l=I||(I={})).EQ="=",l.GT=">",l.LT="<",l.GTE=">=",l.LTE="<=";var nd=function(e,n,t){this.operator=e,this.left=n,this.right=t,this.type=eB.BOOLEAN};(I||(I={})).getSymbol=function(e){return e};var nf=function(e,n,t){this.condition=e,this.trueCase=n,this.falseCase=t,this.type=n.type},np=function(e){this.str=e,this.type=eB.INT},ng=function(e,n){this.array=e,this.predicate=n,this.type=e.type};(d=b||(b={})).AND="&&",d.OR="||",d.NOT="!";var nh=function(e,n){this.operator=e,this.operands=n,this.type=eB.BOOLEAN},nv=function(e,n){this.str=e,this.prefix=n,this.type=eB.BOOLEAN},nm=function(e,n){this.str=e,this.posfix=n,this.type=eB.BOOLEAN},ny=function(e,n){this.str=e,this.pattern=n,this.type=eB.BOOLEAN};(f=N||(N={})).ADD="+",f.SUBTRACT="-",f.MULTIPLY="*",f.DIVIDE="/",f.MODULO="%";var nE=function(e,n,t){this.operator=e,this.left=n,this.right=t,this.type=n.type===eB.DOUBLE||t.type===eB.DOUBLE?eB.DOUBLE:eB.INT},n_=function(){function e(){}return e.replacePlaceholders=function(e,n){var t=this;return e instanceof eK?n:e instanceof nd||e instanceof nE?new e.constructor(e.operator,this.replacePlaceholders(e.left,n),this.replacePlaceholders(e.right,n)):e instanceof nv||e instanceof nm||e instanceof ny?new e.constructor(this.replacePlaceholders(e.str||e.left,n),this.replacePlaceholders(e.prefix||e.pattern||e.right,n)):e instanceof nh?new nh(e.operator,e.operands.map(function(e){return t.replacePlaceholders(e,n)})):e instanceof nf?new nf(this.replacePlaceholders(e.condition,n),this.replacePlaceholders(e.trueCase,n),this.replacePlaceholders(e.falseCase,n)):e instanceof np?new np(this.replacePlaceholders(e.operand||e.source,n)):e instanceof ng?new ng(this.replacePlaceholders(e.array,n),function(o){return t.replacePlaceholders(e.predicate(o),n)}):e},e}(),nw=function(){function e(){}return e.handleSessionValue=function(e){var n=e[0].replace(/^"|"$/g,""),t=e[1];switch(t){case"B":return new e3(n);case"I":return new e6(n);case"D":return new e7(n);case"C":return new e8(n);case"S":return new e9(n);case"DT":return new e5(n);case"A(B)":return new ne(n);case"A(I)":return new nn(n);case"A(D)":return new nt(n);case"A(C)":return new no(n);case"A(S)":return new nr(n);case"A(DT)":return new ni(n);default:throw Error("Unknown session value type: ".concat(t))}},e.handleArrayElement=function(e){return new ns(nI.deserializeNode(e[0]),parseInt(e[1]))},e.handleFilter=function(e){var n=nI.deserializeNode(e[0]),t=nI.deserializeNode(e[1]);return new ng(n,function(e){return n_.replacePlaceholders(t,e)})},e.handleComparison=function(e,n){var t=nI.deserializeNode(n[0]),o=nI.deserializeNode(n[1]);return new nd({"=":I.EQ,">":I.GT,"<":I.LT,">=":I.GTE,"<=":I.LTE}[e],t,o)},e.handleLogical=function(e,n){var t=n.map(function(e){return nI.deserializeNode(e)});return new nh({"&&":b.AND,"||":b.OR,"!":b.NOT}[e],t)},e.handleMath=function(e,n){var t=nI.deserializeNode(n[0]),o=nI.deserializeNode(n[1]);return new nE({"+":N.ADD,"-":N.SUBTRACT,"*":N.MULTIPLY,"/":N.DIVIDE,"%":N.MODULO}[e],t,o)},e.handleStringOperation=function(e,n){var t=nI.deserializeNode(n[0]),o=nI.deserializeNode(n[1]);switch(e){case"^":return new nv(t,o);case"$":return new nm(t,o);case"match":return new ny(t,o);default:throw Error("Unknown string operation: ".concat(e))}},e.handleTypeConversion=function(e,n){var t=nI.deserializeNode(n[0]);switch(e){case"c:int":return new nu(t);case"c:dbl":return new na(t);case"c:str":return new nc(t);case"c:date":return new nl(t);default:throw Error("Unknown type conversion: ".concat(e))}},e.handleConditional=function(e){return new nf(nI.deserializeNode(e[0]),nI.deserializeNode(e[1]),nI.deserializeNode(e[2]))},e.handleCount=function(e){return new np(nI.deserializeNode(e[0]))},e.handleList=function(e,n){var t=n[0].replace(/[\[\]]/g,"");if(0===t.length)switch(e){case"ilst":return new eW([]);case"dlst":return new eQ([]);case"blst":return new eH([]);case"slst":return new eJ([]);case"clst":return new eX([]);case"dtlst":return new e$([]);default:throw Error("Unknown list type: ".concat(e))}var o=t.split(",").map(function(e){return e.trim()});switch(e){case"ilst":return new eW(o.map(function(e){return parseInt(e)}));case"dlst":return new eQ(o.map(function(e){return parseFloat(e)}));case"blst":return new eH(o.map(function(e){return"true"===e}));case"slst":return new eJ(o.map(function(e){return e.replace(/^"|"$/g,"")}));case"clst":return new eX(o.map(function(e){return e.replace(/^'|'$/g,"")}));case"dtlst":return new e$(o.map(function(e){return new e0(parseInt(e.replace(/^date:/,"")))}));default:throw Error("Unknown list type: ".concat(e))}},e.mappings=new Map([["v",e.handleSessionValue],["[]",e.handleArrayElement],["=",function(n){return e.handleComparison("=",n)}],[">",function(n){return e.handleComparison(">",n)}],["<",function(n){return e.handleComparison("<",n)}],[">=",function(n){return e.handleComparison(">=",n)}],["<=",function(n){return e.handleComparison("<=",n)}],["&&",function(n){return e.handleLogical("&&",n)}],["||",function(n){return e.handleLogical("||",n)}],["!",function(n){return e.handleLogical("!",n)}],["+",function(n){return e.handleMath("+",n)}],["-",function(n){return e.handleMath("-",n)}],["*",function(n){return e.handleMath("*",n)}],["/",function(n){return e.handleMath("/",n)}],["%",function(n){return e.handleMath("%",n)}],["^",function(n){return e.handleStringOperation("^",n)}],["$",function(n){return e.handleStringOperation("$",n)}],["match",function(n){return e.handleStringOperation("match",n)}],["c:int",function(n){return e.handleTypeConversion("c:int",n)}],["c:dbl",function(n){return e.handleTypeConversion("c:dbl",n)}],["c:str",function(n){return e.handleTypeConversion("c:str",n)}],["c:date",function(n){return e.handleTypeConversion("c:date",n)}],["if",e.handleConditional],["count",e.handleCount],["filter",e.handleFilter],["ilst",function(n){return e.handleList("ilst",n)}],["dlst",function(n){return e.handleList("dlst",n)}],["blst",function(n){return e.handleList("blst",n)}],["slst",function(n){return e.handleList("slst",n)}],["clst",function(n){return e.handleList("clst",n)}],["dtlst",function(n){return e.handleList("dtlst",n)}]]),e}(),nI=function(){function e(){}return e.deserializeNode=function(e){var n=e.trim();if(n.startsWith("((")&&n.endsWith("))"))return this.deserializeNode(n.slice(1,-1));if(n.startsWith("ph:")){var t=n.substring(3),o=eZ.getTypeFromAbbreviation(t);if(!o)throw Error("Unknown placeholder type code: ".concat(t));return new eK(o)}var r=e4.parsePrimitiveValue(n);if(r)return r;if(n.startsWith("(")&&n.endsWith(")"))return this.deserializeNode(n.slice(1,-1));var i=this.splitArgs(n);if(i.length>0){var s=i[0],a=i.slice(1),u=nw.mappings.get(s);if(u)return u(a)}throw Error("Could not parse serialized string: ".concat(e))},e.splitArgs=function(e){if(!e)return[];for(var n=[],t=e.length,o=0,r=!1,i=!1,s=0,a=0,u=0;u<t;u++){var c=e[u],l=u>0?e[u-1]:"";switch(c){case"(":!r&&!i&&o++;break;case")":!r&&!i&&o--;break;case'"':"\\"!==l&&(r=!r);break;case"'":"\\"!==l&&(i=!i);break;case"[":!r&&!i&&s++;break;case"]":!r&&!i&&s--;break;case",":if(0===o&&!r&&!i&&0===s){var d=e.substring(a,u).trim();d&&n.push(d),a=u+1}}}if(a<t){var d=e.substring(a).trim();d&&n.push(d)}return n},e}(),nb=function(){function e(){}return e.evaluate=function(e,n){var t=nS.evaluateNode(e.left,n),o=nS.evaluateNode(e.right,n);if(null===t||null===o)return e.operator===I.EQ&&t===o;switch(e.operator){case I.EQ:return this.areEqual(t,o);case I.GT:return t>o;case I.GTE:return t>=o;case I.LT:return t<o;case I.LTE:return t<=o}},e.areEqual=function(e,n){return e===n||(e&&"function"==typeof e.equals?e.equals(n):n&&"function"==typeof n.equals?n.equals(e):e===n)},e}(),nN=function(){function e(){}return e.evaluate=function(e,n){var t=this,o=nS.evaluateNode(e.array,n);if(!Array.isArray(o))throw Error("Expected List for filter operation, got ".concat(typeof o));var r=e.array.type;if(!(e.array.type instanceof eB.ARRAY))throw Error("Expected ARRAY type for filter operation");var i=r.elementType;return o.filter(function(o){var r,s=null!=o?(r=t.createValueNode(o,i),e.predicate(r)):e.predicate(new eq(i));return!0===nS.evaluateNode(s,n)})},e.createValueNode=function(e,n){switch(n){case eB.BOOLEAN:return new eU(e);case eB.INT:return new eL(e);case eB.DOUBLE:return new ek(e);case eB.CHAR:return new ej(e);case eB.STRING:return new eV(e);case eB.DATE:return new eY(e);default:throw Error("Unsupported element type: ".concat(n))}},e}(),nA=function(){function e(){}return e.evaluate=function(e,n){switch(e.operator){case b.AND:for(var t=0,o=e.operands;t<o.length;t++){var r=o[t];if(!0!==nS.evaluateNode(r,n))return!1}return!0;case b.OR:for(var i=0,s=e.operands;i<s.length;i++){var r=s[i];if(!0===nS.evaluateNode(r,n))return!0}return!1;case b.NOT:return!0!==nS.evaluateNode(e.operands[0],n)}},e}(),nT=function(){function e(){}return e.evaluate=function(e,n){var t=nS.evaluateNode(e.left,n);if("number"!=typeof t)throw Error("Expected Number for left operand, got ".concat(typeof t));var o=nS.evaluateNode(e.right,n);if("number"!=typeof o)throw Error("Expected Number for right operand, got ".concat(typeof o));var r=!Number.isInteger(t)||!Number.isInteger(o);switch(e.operator){case N.ADD:return r?t+o:Math.trunc(t)+Math.trunc(o);case N.SUBTRACT:return r?t-o:Math.trunc(t)-Math.trunc(o);case N.MULTIPLY:return r?t*o:Math.trunc(t)*Math.trunc(o);case N.DIVIDE:if(r||Math.trunc(t)%Math.trunc(o)!=0)return t/o;return Math.trunc(t)/Math.trunc(o);case N.MODULO:return r?t%o:Math.trunc(t)%Math.trunc(o)}},e}(),nC=function(){function e(){}return e.validateType=function(e,n){if(null==e){if(n!==eB.NULL)throw Error("Expected non-null value for type ".concat(n,", got null"));return}var t=typeof e;function o(n){return"Type mismatch: expected ".concat(n,", got ").concat(t," for value '").concat(e,"'")}if(n===eB.BOOLEAN){if("boolean"!=typeof e)throw Error(o("Boolean"))}else if(n===eB.INT){if("number"!=typeof e||!Number.isInteger(e))throw Error(o("Int"))}else if(n===eB.DOUBLE){if("number"!=typeof e)throw Error(o("Double"))}else if(n===eB.CHAR){if("string"!=typeof e||1!==e.length)throw Error(o("Char"))}else if(n===eB.STRING){if("string"!=typeof e)throw Error(o("String"))}else if(n===eB.REGEX){if(!(e instanceof RegExp))throw Error(o("Regex"))}else if(n===eB.DATE){if(!(e instanceof e0)&&("number"!=typeof e||!Number.isInteger(e)))throw Error(o("Date"))}else if(n instanceof eB.ARRAY){if(!Array.isArray(e))throw Error(o("List"));if(e.length>0){var r=e[0];if(null!=r)try{this.validateType(r,n.elementType)}catch(e){throw Error("Invalid element in list: ".concat(e instanceof Error?e.message:String(e)))}}}else if(n===eB.NULL)throw Error("Non-null value '".concat(e,"' provided for NULL type"))},e}(),nS=function(){function e(){}return e.evaluateNode=function(e,n){var t;if(e instanceof eU||e instanceof eL||e instanceof ek||e instanceof ej||e instanceof eV||e instanceof eG||e instanceof eY)return e.value;if(e instanceof eF)return null;if(e instanceof eW||e instanceof eQ||e instanceof eH||e instanceof eJ||e instanceof eX||e instanceof e$)return e.values;if(e instanceof eK)throw Error("PlaceholderValue can only be used during deserialization, not evaluation");if(e instanceof eq)return null;if(e instanceof e3||e instanceof e6||e instanceof e7||e instanceof e8||e instanceof e9||e instanceof ne||e instanceof nn||e instanceof nt||e instanceof no||e instanceof nr||e instanceof ni){var o=n.get(e.key);return void 0===o?null:(null!==o&&nC.validateType(o,e.type),o)}if(e instanceof e5){var o=n.get(e.key);return void 0===o?null:(null!==o&&nC.validateType(o,e.type),new e0(o))}if(e instanceof nh)return nA.evaluate(e,n);if(e instanceof nd)return nb.evaluate(e,n);if(e instanceof nE)return nT.evaluate(e,n);if(e instanceof nv){var r=this.evaluateNode(e.str,n),i=this.evaluateNode(e.prefix,n);return r.startsWith(i)}if(e instanceof nm){var r=this.evaluateNode(e.str,n),s=this.evaluateNode(e.posfix,n);return r.endsWith(s)}if(e instanceof ny){var r=this.evaluateNode(e.str,n);return this.evaluateNode(e.pattern,n).test(r)}if(e instanceof np){var o=this.evaluateNode(e.str,n);if("string"==typeof o||Array.isArray(o))return o.length;throw Error("Count can only be applied to String or Array, got ".concat(typeof o))}if(e instanceof nf)return this.evaluateNode(e.condition,n)?this.evaluateNode(e.trueCase,n):this.evaluateNode(e.falseCase,n);if(e instanceof ng)return nN.evaluate(e,n);if(e instanceof ns){var a=this.evaluateNode(e.array,n);if(!Array.isArray(a))throw Error("Expected array for element access");return null!==(t=a[e.index])&&void 0!==t?t:null}if(e instanceof na)return Number(this.evaluateNode(e.source,n));if(e instanceof nu)return Math.trunc(this.evaluateNode(e.source,n));if(e instanceof nc)return String(this.evaluateNode(e.source,n));if(e instanceof nl)return e0.fromIsoString(this.evaluateNode(e.source,n));throw Error("Unknown node type: ".concat(e.constructor.name))},e}(),nR=(0,eI.createContext)({hasMosaicContext:!1,store:void 0,actionsManager:void 0,sessionsManager:void 0,responsesManager:void 0,components:void 0,telemetryClient:void 0,eventBus:void 0,uiEffectsPaddingValueToCss:void 0,uiEffectsBorderValueToCss:void 0,uiEffectsShadowValueToCss:void 0,uiEffectsBackgroundColorValueToCss:void 0});nR.displayName="MosaicContext";var nO=t(364780),nD=t(409302),nx=t(249795);(p=A||(A={})).SESSION_MOUNTED="SESSION_MOUNTED",p.SESSION_UNMOUNTED="SESSION_UNMOUNTED",p.SESSION_UNMOUNTED_ALL="SESSION_UNMOUNTED_ALL",p.RESPONSE_MOUNTED="RESPONSE_MOUNTED",p.RESPONSE_UNMOUNTED="RESPONSE_UNMOUNTED",p.UI_EFFECT="UI_EFFECT",p.ACTIONS_V1="ACTION_V1",p.ACTION_TRIGGER="ACTION_TRIGGER";var nM=function(){var e=this;return this.subject=new nx.xQ,this.emitSessionMounted=function(n){var t=n.sessionId;e.subject.next({event:{type:A.SESSION_MOUNTED,payload:{sessionId:t}}})},this.emitSessionUnmounted=function(n){var t=n.sessionId;e.subject.next({event:{type:A.SESSION_UNMOUNTED,payload:{sessionId:t}}})},this.emitSessionUnmountedAll=function(n){var t=n.sessionId;e.subject.next({event:{type:A.SESSION_UNMOUNTED_ALL,payload:{sessionId:t}}})},this.emitResponseMounted=function(n){var t=n.sessionId,o=n.response;e.subject.next({event:{type:A.RESPONSE_MOUNTED,payload:{sessionId:t,response:o}}})},this.emitResponseUnmounted=function(n){var t=n.sessionId,o=n.pageName;e.subject.next({event:{type:A.RESPONSE_UNMOUNTED,payload:{sessionId:t,pageName:o}}})},this.emitUIEffects=function(n){var t=n.sessionId,o=n.data;e.subject.next({event:{type:A.UI_EFFECT,payload:{sessionId:t,data:o}}})},this.emitActionsV1=function(n){var t=n.actions,o=n.sessionId,r=n.logging,i=n.registeredActions;e.subject.next({event:{type:A.ACTIONS_V1,payload:{actions:t,sessionId:o,logging:r,registeredActions:i}}})},this.emitActionTrigger=function(n){var t=n.trigger,o="eventName"in t?t.eventName:nB.getEventName((0,D.__assign)({},t)).eventName;e.subject.next({event:{type:A.ACTION_TRIGGER,trigger:{sessionId:t.sessionId,pageName:t.pageName,logging:t.logging,domEvent:t.domEvent,eventName:o,eventDetail:t.eventDetail}}})},this},nz=function(e){for(var n=e,t=e.logged;!t&&n._cause instanceof eb;)t=n._cause.logged,n=n._cause;!t&&(e.logged=!0,e.isBoundaryError||console.error(e))},nP=t(687808),nB=function(){function e(n){var t=this;this.mosaicProviderActions={actions:{}},this.sessionActions={},this.subscribeToSessionUnmountsAll=function(){t.eventBus.subject.pipe((0,nP.h)(function(e){return e.event.type===A.SESSION_UNMOUNTED_ALL})).subscribe({next:function(e){return(0,D.__awaiter)(t,[e],void 0,function(e){var n=e.event;return(0,D.__generator)(this,function(e){return n.type===A.SESSION_UNMOUNTED_ALL&&this.unregisterSessionActions(n.payload.sessionId),[2]})})}})},this.getRegisteredAction=function(e){var n,o=e.actionType,r=e.session,i=e.registeredActions;if(i&&i[o])return i[o];var s=null===(n=t.sessionActions[r.id])||void 0===n?void 0:n.actions;if(s&&s[o])return s[o];var a=t.mosaicProviderActions.actions;if(a&&a[o])return a[o]},this.executeUIEffectActions=function(e){var n=e.actions,o=e.session;if(0!==n.length){var r=[];n.forEach(function(e){var n,t=null===(n=e.content)||void 0===n?void 0:n.key;t&&!r.includes(t)&&r.push(t)});var i=n.reduce(function(e,n){var t,o=null===(t=n.content)||void 0===t?void 0:t.key;return o&&(e[o]||(e[o]=[]),e[o].push(n)),e},{});r.forEach(function(e){t.eventBus.emitUIEffects({sessionId:o.id,data:i[e].map(function(e){return e.content})})})}},this.executeGenericAction=function(e){var n=e.action,o=e.session,r=e.logging,i=e.registeredActions,s=e.eventDetail,a=t.getRegisteredAction({actionType:n.action_type,session:o,registeredActions:i});if(!a)throw new ez.Action.NotRegistered({action_type:n.action_type,legoId:n.lego_id,legoType:n.lego_type});try{var u=a.fn({legoId:n.lego_id,legoType:n.lego_type,action_type:n.action_type,content:n.content,eventDetail:s,session:o,logging:null!=r?r:{attributes:[]},executeActions:function(e){return t.executeActions({actions:e,sessionId:o.id,logging:r,registeredActions:i})},triggerEvents:function(e){e.forEach(function(e){return t.eventBus.emitActionTrigger(e)})}});if(u instanceof Promise)return u.catch(function(e){throw new ez.Action.ExecutionException({action_type:n.action_type,legoId:n.lego_id,legoType:n.lego_type,cause:e})});return u}catch(e){throw new ez.Action.ExecutionException({action_type:n.action_type,legoId:n.lego_id,legoType:n.lego_type,cause:e})}},this.executeResultBasedAction=function(e){var n=e.action,o=e.session,r=e.logging,i=e.registeredActions,s=e.eventDetail,a=n.content,u=a.primary_action.action_type,c=t.getRegisteredAction({actionType:u,session:o,registeredActions:i});if(!c)throw new ez.Action.NotRegistered({action_type:u,legoId:n.lego_id,legoType:n.lego_type});var l=a.primary_action.content,d=a.on_success.map(function(e){return et.parse(e)}),f=a.on_failure.map(function(e){return et.parse(e)});try{var p=c.fn({legoId:n.lego_id,legoType:n.lego_type,action_type:u,content:l,eventDetail:s,session:o,logging:null!=r?r:{attributes:[]},executeActions:function(e){return t.executeActions({actions:e,sessionId:o.id,logging:r,registeredActions:i})},triggerEvents:function(e){return e.forEach(function(e){return t.eventBus.emitActionTrigger(e)})}});if(p instanceof Promise)return p.then(function(){return t.executeActions({actions:d,sessionId:o.id,logging:r,registeredActions:i})}).catch(function(){return t.executeActions({actions:f,sessionId:o.id,logging:r,registeredActions:i})});return t.executeActions({actions:d,sessionId:o.id,logging:r,registeredActions:i})}catch(e){return t.executeActions({actions:f,sessionId:o.id,logging:r,registeredActions:i})}},this.getEventBasedActionsForEventName=function(e){var n,o,r,i,s=e.eventName,a=e.sessionId,u=e.pageName;if(u){var c=null===(o=null===(n=t.responsesManager.sessionResponses[a])||void 0===n?void 0:n.responses[u])||void 0===o?void 0:o.response;if(!c)throw new ez.Action.ExecutionException({eventName:s,pageName:u,sessionId:a,cause:Error("Response not found when executing event based action")});var l=c.action_triggers.filter(function(e){return e.event_name.startsWith(s)}).map(function(e){return e.action_id}).map(function(e){return c.actions.find(function(n){return n.action_id===e})}).filter(function(e){return void 0!==e});return l}var l=Object.values(null!==(i=null===(r=t.responsesManager.sessionResponses[a])||void 0===r?void 0:r.responses)&&void 0!==i?i:{}).sort(function(e,n){return n.registeredAt.getTime()-e.registeredAt.getTime()}).map(function(e){var n=e.response;return n.action_triggers.filter(function(e){return e.event_name.startsWith(s)}).map(function(e){return e.action_id}).map(function(e){return n.actions.find(function(n){return n.action_id===e})}).filter(function(e){return void 0!==e})});return l.flat()},this.executeEventActions=function(n){return(0,D.__awaiter)(t,[n],void 0,function(n){var t,o,r,i,s,a,u,c,l,d,f,p=n.trigger;return(0,D.__generator)(this,function(n){switch(n.label){case 0:if(p.eventName.startsWith("component::")&&p.domEvent&&(!(t=e.getSourceComponentForDOMEvent(p.domEvent))||!p.eventName.includes(t.componentId)))return[2];o=this.getEventBasedActionsForEventName({eventName:p.eventName,sessionId:p.sessionId,pageName:p.pageName}),r=this.sessionsManager.getSessionOrThrow(p.sessionId),i=o.filter(function(e){return e._action_type!==h.UIEffect}),s=0,a=i,n.label=1;case 1:if(!(s<a.length))return[3,11];u=a[s],n.label=2;case 2:if(n.trys.push([2,8,,10]),u._action_type!==h.Generic||!((c=this.executeGenericAction({action:u,session:r,logging:p.logging,eventDetail:p.eventDetail}))instanceof Promise))return[3,4];return[4,c];case 3:n.sent(),n.label=4;case 4:if(u._action_type!==h.ResultBased||!((l=this.executeResultBasedAction({action:u,session:r,logging:p.logging,eventDetail:p.eventDetail}))instanceof Promise))return[3,6];return[4,l];case 5:n.sent(),n.label=6;case 6:return[4,this.executeEventActions({trigger:{sessionId:p.sessionId,pageName:p.pageName,eventName:"action::".concat(u.action_id,"::ok"),eventDetail:{}}})];case 7:case 9:return n.sent(),[3,10];case 8:return d=n.sent(),nz(new ez.Action.ExecutionException({actionId:u.action_id,eventName:p.eventName,pageName:p.pageName,sessionId:p.sessionId,cause:d})),[4,this.executeEventActions({trigger:{sessionId:p.sessionId,pageName:p.pageName,eventName:"action::".concat(u.action_id,"::err"),eventDetail:{}}})];case 10:return s++,[3,1];case 11:return(f=o.filter(function(e){return e._action_type===h.UIEffect})).length>0&&this.executeUIEffectActions({actions:f,session:r}),[2]}})})},this.subscribeToEventBus=function(){t.eventBus.subject.pipe((0,nP.h)(function(e){var n=e.event;return n.type===A.ACTIONS_V1||n.type===A.ACTION_TRIGGER})).subscribe({next:function(e){return(0,D.__awaiter)(t,[e],void 0,function(e){var n=e.event;return(0,D.__generator)(this,function(e){switch(e.label){case 0:if(n.type!==A.ACTIONS_V1)return[3,2];return[4,this.executeActions({actions:n.payload.actions,sessionId:n.payload.sessionId,logging:n.payload.logging,registeredActions:n.payload.registeredActions})];case 1:e.sent(),e.label=2;case 2:if(n.type!==A.ACTION_TRIGGER)return[3,4];return[4,this.executeEventActions({trigger:n.trigger})];case 3:e.sent(),e.label=4;case 4:return[2]}})})}})},this.eventBus=n.eventBus,this.sessionsManager=n.sessionsManager,this.responsesManager=n.responsesManager,this.subscribeToEventBus(),this.subscribeToSessionUnmountsAll()}return e.prototype.registerMosaicProviderActions=function(e){this.mosaicProviderActions.actions=(0,D.__assign)((0,D.__assign)({},this.mosaicProviderActions.actions),e)},e.prototype.unregisterMosaicProviderActions=function(){this.mosaicProviderActions={actions:{}}},e.prototype.registerSessionActions=function(e,n){var t;this.sessionActions[e]=(0,D.__assign)((0,D.__assign)({},this.sessionActions[e]),{actions:(0,D.__assign)((0,D.__assign)({},null===(t=this.sessionActions[e])||void 0===t?void 0:t.actions),n)})},e.prototype.unregisterSessionActions=function(e){this.sessionActions[e]&&(this.sessionActions[e]=(0,D.__assign)((0,D.__assign)({},this.sessionActions[e]),{actions:{}}))},e.prototype.executeActions=function(e){return(0,D.__awaiter)(this,arguments,void 0,function(e){var n,t,o,r,i,s,a,u,c=e.actions,l=e.sessionId,d=e.logging,f=e.registeredActions;return(0,D.__generator)(this,function(e){switch(e.label){case 0:n=this.sessionsManager.getSessionOrThrow(l),t=c.map(function(e){return et.parse(e)}),o=0,r=t,e.label=1;case 1:if(!(o<r.length))return[3,6];if((i=r[o])._action_type!==h.Generic||!((s=this.executeGenericAction({action:i,session:n,logging:d,registeredActions:f}))instanceof Promise))return[3,3];return[4,s];case 2:e.sent(),e.label=3;case 3:if(i._action_type!==h.ResultBased||!((a=this.executeResultBasedAction({action:i,session:n,logging:d,registeredActions:f}))instanceof Promise))return[3,5];return[4,a];case 4:e.sent(),e.label=5;case 5:return o++,[3,1];case 6:return(u=t.filter(function(e){return e._action_type===h.UIEffect})).length>0&&this.executeUIEffectActions({actions:u,session:n}),[2]}})})},e.getEventName=function(e){switch(e.kind){case y.OnClick:return{eventName:"".concat(e.origin,"::").concat(e.source.componentId,"::on_click")};case y.OnChange:return{eventName:"".concat(e.origin,"::").concat(e.eventDetail.key,"::on_change")};default:throw new ez.Action.ExecutionException({cause:Error("Unknown event kind: ".concat(e.kind))})}},e.getSourceComponentForDOMEvent=function(e){var n=("nativeEvent"in e?e.nativeEvent:e).target.closest("[data-mosaic-view-lego-id]");if(n){var t=n.getAttribute("data-mosaic-view-lego-id");if(t)return{componentId:t}}},e}(),nU=t(938122),nL=function(){function e(e){var n,t=this;return this.selectionSingleExtensions={},this.registerSelectionSingleExtensions=function(e){e.forEach(function(e){e._type===E.selectionSingle&&(t.selectionSingleExtensions[e.value.key]=e.value)})},this.selectComponentState=function(e,n,o){void 0===o&&(o=t.store.getState());var r=n.getComponentStateExtension(e);if(r){if(r._type===E.state)return t.selectKeyState(r.value.key,o);var i=Object.keys(r.value);if(i.length){var s={};return i.forEach(function(e){var n=r.value[e];s[e]=t.selectKeyState(n,o)}),s}}},this.updateComponentState=function(e,n,o){var r=o.getComponentStateExtension(e);if(!r)throw new ez.SDKRuntimeError("You are attempting to update state for a component that does not have state extensions");if(r._type===E.state)t.updateKeyState(r.value.key,n);else{if("object"!=typeof n||Array.isArray(n))throw new ez.SDKRuntimeError("newState must be an object with keys ".concat(Object.values(r.value).join(", "),". Each key is optional."));var i={},s=Object.keys(r.value);Object.keys(null!=n?n:{}).forEach(function(e){s.includes(e)&&(i[r.value[e]]=n[e])}),t.store.setState(function(e){var n,o;return{session:(0,D.__assign)((0,D.__assign)({},e.session),((n={})[t.id]=(0,D.__assign)((0,D.__assign)({},e.session[t.id]),{componentState:(0,D.__assign)((0,D.__assign)({},null===(o=e.session[t.id])||void 0===o?void 0:o.componentState),i)}),n))}})}},this.selectKeyState=function(e,n){var o;return void 0===n&&(n=t.store.getState()),null===(o=n.session[t.id])||void 0===o?void 0:o.componentState[e]},this.updateKeyState=function(e,n){var o,r=((o={})[e]=n,o);t.selectionSingleExtensions[e]?t.selectionSingleExtensions[e].options.forEach(function(e){r[e]=e===n}):Object.keys(t.selectionSingleExtensions).forEach(function(o){t.selectionSingleExtensions[o].options.includes(e)&&(t.selectionSingleExtensions[o].options.forEach(function(n){n!==e&&(r[n]=!1)}),r[o]=n?e:"")}),t.store.setState(function(e){var n,o;return{session:(0,D.__assign)((0,D.__assign)({},e.session),((n={})[t.id]=(0,D.__assign)((0,D.__assign)({},e.session[t.id]),{componentState:(0,D.__assign)((0,D.__assign)({},null===(o=e.session[t.id])||void 0===o?void 0:o.componentState),r)}),n))}})},this.getComponentsState=function(e){var n;return void 0===e&&(e=t.store.getState()),null===(n=e.session[t.id])||void 0===n?void 0:n.componentState},this.store=e.store,this.id=null!==(n=e.id)&&void 0!==n?n:(0,nU.Z)(),this}return e.prototype.clearComponentsState=function(){var e=this;this.store.setState(function(n){var t;return{session:(0,D.__assign)((0,D.__assign)({},n.session),((t={})[e.id]=(0,D.__assign)((0,D.__assign)({},n.session[e.id]),{componentState:{}}),t))}})},e.prototype.clear=function(){var e=this;this.store.setState(function(n){var t;return{session:(0,D.__assign)((0,D.__assign)({},n.session),((t={})[e.id]={componentState:{}},t))}})},e}(),nk=t(662990),nj=function(){function e(e){var n=e.store,t=e.eventBus,o=this;this.sessions={},this.subscribeToSessionMounts=function(){o.eventBus.subject.pipe((0,nP.h)(function(e){var n=e.event;return n.type===A.SESSION_MOUNTED||n.type===A.SESSION_UNMOUNTED})).subscribe({next:function(e){return(0,D.__awaiter)(o,[e],void 0,function(e){var n=e.event;return(0,D.__generator)(this,function(e){return n.type===A.SESSION_MOUNTED&&this.sessions[n.payload.sessionId].numMountedSessions++,n.type===A.SESSION_UNMOUNTED&&(this.sessions[n.payload.sessionId].numMountedSessions--,this.sessions[n.payload.sessionId].numMountedSessions<=0&&this.eventBus.emitSessionUnmountedAll({sessionId:n.payload.sessionId})),[2]})})}})},this.subscribeToSessionComponentsState=function(e){return{storeUnsubScribe:o.store.subscribe(function(n){var t;return null===(t=n.session[e.id])||void 0===t?void 0:t.componentState},function(n,t){Object.keys(n).filter(function(e){return!(0,nk.X)(null==n?void 0:n[e],null==t?void 0:t[e])}).forEach(function(r){o.eventBus.emitActionTrigger({trigger:{sessionId:e.id,kind:y.OnChange,origin:m.SessionStore,eventDetail:{key:r,previousValue:null==t?void 0:t[r],newValue:null==n?void 0:n[r]}}})})},{equalityFn:nk.X})}},this.store=n,this.eventBus=t,this.subscribeToSessionMounts()}return e.prototype.getOrCreateSession=function(e){if(this.sessions[e])return this.sessions[e].session;var n=new nL({id:e,store:this.store}),t=this.subscribeToSessionComponentsState(n).storeUnsubScribe;return this.sessions[e]={session:n,numMountedSessions:0,storeUnsubScribe:t},n},e.prototype.getSessionOrThrow=function(e){var n,t=null===(n=this.sessions[e])||void 0===n?void 0:n.session;if(!t)throw new ez.SDKRuntimeError("Session with id ".concat(e," not found in SessionsManager. Make sure there is a view factory rendered with this session id ").concat(e,"."));return t},e}(),nV=function(){function e(e){var n=e.eventBus,t=this;this.sessionResponses={},this.subscribeToSessionUnmountsAll=function(){t.eventBus.subject.pipe((0,nP.h)(function(e){return e.event.type===A.SESSION_UNMOUNTED_ALL})).subscribe({next:function(e){return(0,D.__awaiter)(t,[e],void 0,function(e){var n=e.event;return(0,D.__generator)(this,function(e){return n.type===A.SESSION_UNMOUNTED_ALL&&delete this.sessionResponses[n.payload.sessionId],[2]})})}})},this.subscribeToResponseMounts=function(){t.eventBus.subject.pipe((0,nP.h)(function(e){var n=e.event;return n.type===A.RESPONSE_MOUNTED||n.type===A.RESPONSE_UNMOUNTED})).subscribe({next:function(e){return(0,D.__awaiter)(t,[e],void 0,function(e){var n,t,o,r=e.event;return(0,D.__generator)(this,function(e){return r.type===A.RESPONSE_MOUNTED&&this.registerResponse(r.payload.sessionId,r.payload.response),r.type===A.RESPONSE_UNMOUNTED&&(n=null===(t=this.sessionResponses[r.payload.sessionId])||void 0===t?void 0:t.responses[r.payload.pageName])&&(n.numMountedResponses<=1?null===(o=this.sessionResponses[r.payload.sessionId])||void 0===o||delete o.responses[r.payload.pageName]:n.numMountedResponses--),[2]})})}})},this.eventBus=n,this.subscribeToSessionUnmountsAll(),this.subscribeToResponseMounts()}return e.prototype.registerResponse=function(e,n){var t,o,r,i,s,a,u,c=null===(r=null===(o=this.sessionResponses[e])||void 0===o?void 0:o.responses[n.page_name])||void 0===r?void 0:r.numMountedResponses;void 0===c&&(c=0),this.sessionResponses[e]=(0,D.__assign)((0,D.__assign)({},this.sessionResponses[e]),{responses:(0,D.__assign)((0,D.__assign)({},null!==(s=null===(i=this.sessionResponses[e])||void 0===i?void 0:i.responses)&&void 0!==s?s:{}),((t={})[n.page_name]={response:{page_name:n.page_name,actions:n.actions,action_triggers:n.action_triggers},registeredAt:new Date,numMountedResponses:c+1},t)),actionIdToActionMap:n.actions.reduce(function(e,n){return e[n.action_id]=n,e},null!==(u=null===(a=this.sessionResponses[e])||void 0===a?void 0:a.actionIdToActionMap)&&void 0!==u?u:{})})},e}(),nG=function(e){var n=e._store,t=e._eventBus,o=e._actionsManager,r=e._sessionsManager,i=e._responsesManager,s=e.components,a=e.actions,u=e.actionComponents,c=e.telemetryClient,l=e.uiEffectsPaddingValueToCss,d=e.uiEffectsBorderValueToCss,f=e.uiEffectsShadowValueToCss,p=e.uiEffectsBackgroundColorValueToCss,g=e.children,h=eI.useMemo(function(){return n?n instanceof Function?n():n:(0,nO.M)((0,nD.XR)(function(e){return{session:{}}}))},[n]),v=eI.useMemo(function(){return t?t instanceof Function?t():t:new nM},[t]),m=eI.useMemo(function(){return r?"function"==typeof r?r():r:new nj({store:h,eventBus:v})},[r,h,v]),y=eI.useMemo(function(){return i?"function"==typeof i?i():i:new nV({eventBus:v})},[i,v]),E=eI.useMemo(function(){return o?"function"==typeof o?o():o:new nB({eventBus:v,sessionsManager:m,responsesManager:y})},[o,v,m]),_=eI.useMemo(function(){return s?"function"==typeof s?s():s:void 0},[s]);eI.useEffect(function(){var e=a?"function"==typeof a?a():a:void 0;e&&E.registerMosaicProviderActions(e)},[a]),eI.useEffect(function(){return function(){E.unregisterMosaicProviderActions()}},[E]);var w=eI.useMemo(function(){return u?"function"==typeof u?u():u:{}},[u]),I=eI.useMemo(function(){return Object.keys(w).map(function(e){var n=w[e];return{actionType:e,registeredAction:n}})},[w]),b=eI.useMemo(function(){return{hasMosaicContext:!0,store:h,actionsManager:E,sessionsManager:m,responsesManager:y,components:_,telemetryClient:c,eventBus:v,uiEffectsPaddingValueToCss:l,uiEffectsBorderValueToCss:d,uiEffectsShadowValueToCss:f,uiEffectsBackgroundColorValueToCss:p}},[h,E,m,_,c,v,l,d,f,p]);return eI.createElement(nR.Provider,{value:b},I.map(function(e){var n=e.actionType,t=e.registeredAction.ActionComponent;return eI.createElement(t,{key:n,registerAction:function(e){var t;E.mosaicProviderActions.actions[n]&&nz(new ez.SDKRuntimeError("An Action Component of actionType=".concat(n,' has already been registered. Action Components should only be registered once. Check your Action Component to verify that "registerAction" is only called once throughout the component\'s lifecycle.'))),E.registerMosaicProviderActions(((t={})[n]=e,t))}})}),g)},nY=function(e){var n=e.children,t=(0,D.__rest)(e,["children"]),o=eI.useContext(nR);return o&&o.hasMosaicContext?(nz(new ez.SDKRuntimeError("MosaicProvider can only be used once. Please ensure that you are not using the MosaicProvider more than once in your page or application. The general pattern is to use the MosaicProvider at the root of your application and not in any nested components.")),null):eI.createElement(nG,(0,D.__assign)({},t),n)};function nF(){var e,n=eI.useContext(nR);if(!(null==n?void 0:n.hasMosaicContext))throw new ez.SDKRuntimeError("MosaicContext not found in context. Did you forget to wrap your app with <MosaicProvider></MosaicProvider>?");if(!n.store)throw new ez.SDKRuntimeError("MosaicContext store not found in context");if(!n.eventBus)throw new ez.SDKRuntimeError("MosaicContext eventBus not found in context");if(!n.actionsManager)throw new ez.SDKRuntimeError("MosaicContext actionsManager not found in context");if(!n.sessionsManager)throw new ez.SDKRuntimeError("MosaicContext sessionsManager not found in context");if(!n.responsesManager)throw new ez.SDKRuntimeError("MosaicContext responsesManager not found in context");return{store:n.store,actionsManager:n.actionsManager,sessionsManager:n.sessionsManager,responsesManager:n.responsesManager,components:null!==(e=n.components)&&void 0!==e?e:{},telemetryClient:n.telemetryClient,eventBus:n.eventBus,uiEffectsPaddingValueToCss:n.uiEffectsPaddingValueToCss,uiEffectsBorderValueToCss:n.uiEffectsBorderValueToCss,uiEffectsShadowValueToCss:n.uiEffectsShadowValueToCss,uiEffectsBackgroundColorValueToCss:n.uiEffectsBackgroundColorValueToCss}}var nK=(0,eI.createContext)({hasViewFactory:!1,session:void 0,components:void 0});nK.displayName="ViewFactoryContext";var nq=t(787614),nW=function(e){var n=e.sessionID,t=e.components,o=e.actions,r=e.actionComponents,i=e.children,s=nF(),a=eI.useMemo(function(){return s.store},[s.store]),u=eI.useMemo(function(){return null!=n?n:(0,nU.Z)()},[n]),c=eI.useMemo(function(){return s.sessionsManager.getOrCreateSession(u)},[u,a]),l=eI.useMemo(function(){var e;return(0,D.__assign)((0,D.__assign)({},null!==(e=s.components)&&void 0!==e?e:{}),t?"function"==typeof t?t():t:{})},[s.components,t]);eI.useEffect(function(){var e=o?"function"==typeof o?o():o:void 0;e&&s.actionsManager.registerSessionActions(c.id,e)},[o]),eI.useEffect(function(){var e;return null===(e=s.eventBus)||void 0===e||e.emitSessionMounted({sessionId:c.id}),function(){var e;null===(e=s.eventBus)||void 0===e||e.emitSessionUnmounted({sessionId:c.id})}},[s.eventBus,c.id]);var d=eI.useMemo(function(){return(0,D.__assign)({},r?"function"==typeof r?r():r:{})},[r]),f=eI.useMemo(function(){return Object.keys(d).map(function(e){var n=d[e];return{actionType:e,registeredAction:n}})},[d]),p=eI.useMemo(function(){return{hasViewFactory:!0,session:c,store:a,components:l}},[c,a,l]);return eI.createElement(nK.Provider,{value:p},f.map(function(e){var n=e.actionType,t=e.registeredAction.ActionComponent;return eI.createElement(t,{key:n,registerAction:function(e){var t,o;(null===(o=s.actionsManager.sessionActions[c.id])||void 0===o?void 0:o.actions[n])&&nz(new ez.SDKRuntimeError("An Action Component of actionType=".concat(n,' has already been registered. Action Components should only be registered once. Check your Action Component to verify that "registerAction" is only called once throughout the component\'s lifecycle.'))),s.actionsManager.registerSessionActions(c.id,((t={})[n]=e,t))}})}),i)},nQ=function(e){var n=e.children,t=(0,D.__rest)(e,["children"]);return eI.createElement(nq.SV,{fallbackRender:function(e){var n=e.error;return t.ErrorComponent?eI.createElement(t.ErrorComponent,{error:n}):null},onError:function(e){if(e instanceof eb)e.isBoundaryError=!0,nz(e);else{var n=new ez.Response.RenderError("Failed to render mosaic response",{cause:e});n.isBoundaryError=!0,nz(n)}}},eI.createElement(nW,(0,D.__assign)({},t),n))};function nH(){var e=eI.useContext(nK);if(!(null==e?void 0:e.hasViewFactory))throw new ez.SDKRuntimeError("ViewFactory not found in context. Did you forget to wrap your <MosaicView/> with <ViewFactoryProvider></ViewFactoryProvider>?");if(!e.session)throw new ez.SDKRuntimeError("ViewFactory session not found in context.");if(!e.components)throw new ez.SDKRuntimeError("ViewFactory components not found in context");return{session:e.session,components:e.components}}var nJ=function(){function e(n){var t,o,r,i=this;this.getComponentExtensions=function(e){return i.getComponentByLegoIdOrThrow(e).extensions},this.getComponentStateExtension=function(e){var n=i.getComponentExtensions(e).find(function(e){return e._type===E.state||e._type===E.stateComplex});if(n)return n},this.getComponentUIEffectExtensions=function(e){return i.getComponentExtensions(e).filter(function(e){return e._type===E.uiEffect})},this.getGroupByName=function(e){return i.groupNameToGroupMap[e]},this.getGroupByNameOrThrow=function(e){var n=i.getGroupByName(e);if(!n)throw new ez.Response.ParseError("group with name ".concat(e," does not exist in response"));return n},this.getSectionById=function(e,n){return i.getGroupByNameOrThrow(e).sectionIdToSectionMap[n]},this.getSectionByIdOrThrow=function(e,n){var t=i.getSectionById(e,n);if(!t)throw new ez.Response.ParseError("group ".concat(e," either does not exist in response or does not have a section with id ").concat(n));return t},this.getComponentByLegoId=function(e){return i.legoIdToComponentMap[e]},this.getComponentByLegoIdOrThrow=function(e){var n=i.getComponentByLegoId(e);if(!n)throw new ez.Response.ParseError("".concat(e," does not exist in response"));return n},this.getPaddingComponentChildLegoId=function(e){var n,t=i.getComponentByLegoIdOrThrow(e);if("common.prism.padding"!==t.lego_type)return t.lego_id;var o=null===(n=t.content)||void 0===n?void 0:n.block;if(o)return i.getPaddingComponentChildLegoId(o)},this.componentTriggersEvent=function(e,n){var t,o;return(null!==(o=null===(t=i.componentIdToEventNamesMap[e])||void 0===t?void 0:t.eventNames)&&void 0!==o?o:[]).some(function(e){return e.endsWith("::".concat(n))})},this.rawJSON=n.json instanceof e?n.json.getJSON():n.json;var s=ew.safeParse(this.rawJSON);if(!s.success)throw new ez.Response.ParseError("Failed to parse mosaic response",{cause:s.error,data:{json:n.json}});this.page_name=null!==(t=s.data.page_name)&&void 0!==t?t:(0,nU.Z)(),this.metadata=s.data.metadata,this.groups=s.data.groups,this.data=s.data.data,this.actions=null!==(o=s.data.actions)&&void 0!==o?o:[],this.action_triggers=null!==(r=s.data.action_triggers)&&void 0!==r?r:[],this.logging=s.data.logging,this.groupNameToGroupMap=this.groups.reduce(function(e,n){return e[n.group_name]=(0,D.__assign)((0,D.__assign)({},n),{sectionIdToSectionMap:n.sections.reduce(function(e,n){return e[n.section_id]=n,e},{})}),e},{}),this.legoIdToComponentMap=this.data.reduce(function(e,n){return e[n.lego_id]=n,e},{}),this.componentIdToEventNamesMap=this.data.reduce(function(e,n){return e[n.lego_id]={eventNames:i.action_triggers.filter(function(e){return e.event_name.startsWith("component::".concat(n.lego_id,"::"))}).map(function(e){return e.event_name})},e},{})}return e.prototype.getJSON=function(){return{page_name:this.page_name,metadata:this.metadata,groups:this.groups,data:this.data,logging:this.logging,actions:this.actions,action_triggers:this.action_triggers}},e}(),nX=(0,eI.createContext)({hasMosaicResponse:!1,response:void 0});function n$(){var e=eI.useContext(nX);if(!(null==e?void 0:e.hasMosaicResponse))throw new ez.SDKRuntimeError("MosaicResponse not found in context. Did you forget to wrap your app with <MosaicResponseContextProvider></MosaicResponseContextProvider>?");if(!e.response)throw new ez.SDKRuntimeError("response not found in MosaicResponse context. Did you forget to wrap your app with <MosaicResponseContextProvider></MosaicResponseContextProvider>?");return{response:e.response}}nX.displayName="MosaicResponseContext";var nZ=function(){var e=eI.useRef(!0),n=e.current;return e.current=!1,n},n0=function(e){var n,t=e.source,o=e.children,r=eI.useContext(nK),i=eI.useContext(nR),s=eI.useState(!0),a=s[0],u=s[1],c=eI.useState(null),l=c[0],d=c[1],f=eI.useState("response"in t?new nJ({json:t.response}):void 0),p=f[0],g=f[1],h=nZ();eI.useEffect(function(){"response"in t?h||g(new nJ({json:t.response})):(u(!0),fetch(t.url,(0,D.__assign)({headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"},t.requestInit)).then(function(e){if(!e.ok)throw new ez.Response.DownloadError("Failed to load mosaic response from url ".concat(t.url,", ").concat(e.status,", ").concat(e.statusText),{data:{response:e}});return e.json()}).then(function(e){g(new nJ({json:e})),d(null)}).catch(function(e){e instanceof ez.Response.DownloadError?d(e):d(new ez.Response.DownloadError("Failed to load mosaic response from url ".concat(t.url,", ").concat(e.message),{cause:e}))}).finally(function(){u(!1)}))},[t]),eI.useEffect(function(){var e,n,t=null===(e=r.session)||void 0===e?void 0:e.id;return p&&t&&(null===(n=i.eventBus)||void 0===n||n.emitResponseMounted({sessionId:t,response:p})),function(){var e,n,t=null===(e=r.session)||void 0===e?void 0:e.id;p&&t&&(null===(n=i.eventBus)||void 0===n||n.emitResponseUnmounted({sessionId:t,pageName:p.page_name}))}},[p,null===(n=r.session)||void 0===n?void 0:n.id,i.eventBus]);var v=eI.useMemo(function(){return{hasMosaicResponse:!0,response:p}},[p]);return"url"in t&&a?t.LoadingComponent?eI.createElement(t.LoadingComponent,null):null:l?eI.createElement(ez.ThrowErrorComponent,{error:l}):p?eI.createElement(nX.Provider,{value:v},o):eI.createElement(ez.ThrowErrorComponent,{error:new ez.Response.DownloadError("Failed to set mosaic response")})},n1=(0,eI.createContext)({hasMosaicLogging:!1,attributes:[]});n1.displayName="MosaicLoggingContext";var n2=function(e){var n=e.source,t=e.children,o=n$().response,r=eI.useContext(n1),i=eI.useMemo(function(){var e,t,r;try{if("loggingJSON"in n)return n.loggingJSON;if("groupName"in n){if("sectionId"in n)return null===(e=o.getSectionById(n.groupName,n.sectionId))||void 0===e?void 0:e.logging;return null===(t=o.getGroupByName(n.groupName))||void 0===t?void 0:t.logging}if("legoId"in n)return null===(r=o.getComponentByLegoId(n.legoId))||void 0===r?void 0:r.logging;return}catch(e){throw new ez.Response.ParseError("Error getting logging JSON",e)}},[n]),s=eI.useMemo(function(){var e;try{var n=null!==(e=null==r?void 0:r.attributes)&&void 0!==e?e:[],t=null==i?void 0:i.attributes;return(0,D.__spreadArray)((0,D.__spreadArray)([],n.filter(function(e){return e.should_pass_down}),!0),null!=t?t:[],!0)}catch(e){throw new ez.Response.ParseError("Error parsing logging attributes",e)}},[r,i]),a=eI.useMemo(function(){return{hasMosaicLogging:!0,attributes:s}},[s]);return eI.createElement(n1.Provider,{value:a},t)},n4=t(918564),n3=function(e){var n,t=e.source,o=e.propertyTypes,r=e.onChange,i=e.sessionId,s=nF(),a=eI.useContext(nK),u=eI.useContext(nX),c=eI.useMemo(function(){return null!=o?o:void 0},null!=o?o:[]),l=eI.useMemo(function(){if(i)return i;if(null==a?void 0:a.session)return null==a?void 0:a.session.id;throw new ez.SDKRuntimeError('session not found in "ViewFactoryContext". It looks like you have not provided a session ID so the expectation is for you to execute "useUIEffects" within a "ViewFactoryProvider".')},[i,null===(n=null==a?void 0:a.session)||void 0===n?void 0:n.id]),d=eI.useMemo(function(){if(!("legoId"in t))return t;var e,n=null!==(e=t.response)&&void 0!==e?e:null==u?void 0:u.response;if(!n)throw new ez.SDKRuntimeError('Mosaic response not passed in source and not found in context. When the "source" is from a legoId, you must execute "useUIEffects" from within a "MosaicView"');return(0,D.__assign)((0,D.__assign)({},t),{response:n})},["legoId"in t?t.legoId:t.keys.join(","),null==u?void 0:u.response]),f=eI.useRef(r);eI.useEffect(function(){f.current=r},[r]);var p=eI.useRef(function(e){for(var n=e.data,t=[],o=0;o<n.length;o++){var r=n[o];if(-1===("legoId"in d?d.response.getComponentUIEffectExtensions(d.legoId).map(function(e){return e.value.key}):d.keys).indexOf(r.key)||c&&c.length>0&&!c.includes(r.property.type))return;t.push(r)}if(t.length>0)return f.current({uiEffects:t})}),g=eI.useCallback(function(e){var n=e.eventBus,t=e.sessionId;return n.subject.pipe((0,nP.h)(function(e){return e.event.type===A.UI_EFFECT&&e.event.payload.sessionId===t})).subscribe(function(e){var n=e.event;p.current({data:n.payload.data})})},[]),h=eI.useRef(g({eventBus:s.eventBus,sessionId:l}));eI.useEffect(function(){return h.current&&h.current.unsubscribe(),h.current=g({eventBus:s.eventBus,sessionId:l}),function(){h.current.unsubscribe()}},[l,s.eventBus])};(g=T||(T={})).Page="page",g.Group="group",g.Section="section",g.Component="component";var n6=n4.default.div.withConfig({componentId:"sc-4b9435fe-0"})(S||(S=(0,D.__makeTemplateObject)(["\n  /*\n   * Base styles that are applied to all view boxes.\n   * TODO: We'll update more styles as we settle on the design with mobile.\n   */\n  ","\n\n  // for any content that overflows, we do not want it to cause the parent dimensions to change\n  overflow: auto;\n\n  ","// allow parent to pass in and override styles\n"],["\n  /*\n   * Base styles that are applied to all view boxes.\n   * TODO: We'll update more styles as we settle on the design with mobile.\n   */\n  ","\n\n  // for any content that overflows, we do not want it to cause the parent dimensions to change\n  overflow: auto;\n\n  ","// allow parent to pass in and override styles\n"])),function(e){if(e.type!==T.Component)return(0,n4.css)(C||(C=(0,D.__makeTemplateObject)(["\n        display: grid;\n        grid-template-columns: 1fr;\n        grid-auto-flow: row;\n        grid-auto-rows: max-content;\n        min-height: 0;\n      "],["\n        display: grid;\n        grid-template-columns: 1fr;\n        grid-auto-flow: row;\n        grid-auto-rows: max-content;\n        min-height: 0;\n      "])))},function(e){return e.css}),n7=function(e){var n=e.children,t=e.source,o=e.css,r=eI.useMemo(function(){if("sessionId"in t)return T.Page;if("groupName"in t)return T.Group;if("sectionId"in t)return T.Section;if("legoId"in t)return T.Component;throw new ez.SDKRuntimeError("Invalid source supplied to ViewBox")},[t]);return eI.createElement(n6,{css:o,type:r,"data-mosaic-view-type":r,"data-mosaic-view-group-name":"groupName"in t?t.groupName:void 0,"data-mosaic-view-section-id":"sectionId"in t?t.sectionId:void 0,"data-mosaic-view-lego-id":"legoId"in t?t.legoId:void 0,"data-mosaic-view-lego-type":"legoType"in t?t.legoType:void 0},n)};function n8(e){var n,t=this,o=void 0===e?{}:e,r=o.session,i=o.registeredActions,s=o.logging,a=nF(),u=eI.useRef(a);eI.useEffect(function(){u.current=a},[a]);var c=eI.useContext(nK),l=eI.useRef(c);eI.useEffect(function(){l.current=c},[c]);var d=eI.useMemo(function(){return r||((null==c?void 0:c.session)?c.session.id:void 0)},[r,null===(n=null==c?void 0:c.session)||void 0===n?void 0:n.id]),f=eI.useRef(d);eI.useEffect(function(){f.current=d},[d]);var p=eI.useContext(n1),g=eI.useRef(p);eI.useEffect(function(){g.current=p},[p]);var h=eI.useMemo(function(){return s||p||{attributes:[]}},[s,p]),v=eI.useRef(h),m=eI.useRef(function(e){return(0,D.__awaiter)(t,void 0,void 0,function(){return(0,D.__generator)(this,function(n){if(!f.current)throw new ez.SDKRuntimeError("Session not found in context. If you are not using this hook from within a Mosaic ViewFactory context, please provide a sessionId as an argument to the hook.");return[2,a.eventBus.emitActionsV1({actions:e,sessionId:f.current,logging:v.current,registeredActions:i})]})})}),y=eI.useRef(function(e){return e.forEach(function(e){var n,t,o=null!==(n=e.sessionId)&&void 0!==n?n:f.current;if(!o)throw new ez.SDKRuntimeError("Found no sessionId in event or context. If you are not using this hook from within a Mosaic ViewFactory context, please provide a sessionId in the event or as an argument to the hook.");u.current.eventBus.emitActionTrigger({trigger:(0,D.__assign)((0,D.__assign)({},e),{sessionId:o,logging:null!==(t=e.logging)&&void 0!==t?t:v.current,eventDetail:e.eventDetail})})})});return{executeDynamicActions:m.current,triggerEvents:y.current}}var n9=function(e){var n,t,o,r=e.legoId,i=e.css,s=nF(),a=s.uiEffectsPaddingValueToCss,u=s.uiEffectsBorderValueToCss,c=s.uiEffectsShadowValueToCss,l=s.uiEffectsBackgroundColorValueToCss,d=n$().response,f=nH(),p=f.components,g=f.session,h=eI.useState(null),m=h[0],y=h[1],E=eI.useState(null),w=E[0],I=E[1],b=eI.useState({isVisible:void 0,isDisabled:void 0}),N=b[0],A=b[1],T=eI.useCallback(function(e){A({backgroundColorCss:e.backgroundColorCss,borderCss:e.borderCss,isDisabled:e.isDisabled,paddingCss:e.paddingCss,shadowCss:e.shadowCss,isVisible:e.isVisible})},[A]),C=eI.useMemo(function(){return d.getComponentByLegoIdOrThrow(r)},[d,r]);eI.useEffect(function(){C.extensions&&g.registerSelectionSingleExtensions(C.extensions)},[C.extensions]);var S=C.lego_type,x=null!==(n=C.failure_mode)&&void 0!==n?n:_.REQUIRED,M=eI.useMemo(function(){var e=p[S];if(!e)return{MainComponent:function(){return eI.createElement(ez.ThrowErrorComponent,{error:new ez.Component.NotRegistered({legoId:r,legoType:S,failureMode:x})})}};var n="Component"in e?e.Component:e.AsyncComponent;return n?{MainComponent:n,ErrorComponent:"Component"in e?e.Error:e.AsyncError}:{MainComponent:function(){return eI.createElement(ez.ThrowErrorComponent,{error:new ez.Component.NotRegistered({legoId:r,legoType:S,failureMode:x,cause:Error("component with lego type ".concat(S," does not have a registered Component or AsyncComponent"))})})}}},[S,p]),z=M.MainComponent,P=M.ErrorComponent,B=eI.useMemo(function(){var e,n,t;return(null!==(n=null===(e=C.content)||void 0===e?void 0:e.actions)&&void 0!==n?n:[]).concat(null!==(t=C.actions)&&void 0!==t?t:[])},[null===(t=C.content)||void 0===t?void 0:t.actions,C.actions]),U=n8(),L=U.executeDynamicActions,k=U.triggerEvents,j=eI.useCallback(function(){return L(B)},[L,B]),V=eI.useMemo(function(){var e,n;return null!==(n=null===(e=C.content)||void 0===e?void 0:e.children)&&void 0!==n?n:[]},[null===(o=C.content)||void 0===o?void 0:o.children]),G=eI.useMemo(function(){return"string"==typeof C.content?JSON.parse(C.content):C.content},[C.content]),Y=eI.useMemo(function(){return Object.keys(null!=G?G:{}).filter(function(e){return"actions"!==e&&"children"!==e}).reduce(function(e,n){return e[n]=(null!=G?G:{})[n],e},{})},[G]);n3({source:{legoId:r},onChange:eI.useCallback(function(e){var n=e.uiEffects,t={backgroundColorCss:void 0,borderCss:void 0,isDisabled:void 0,paddingCss:void 0,shadowCss:void 0,isVisible:void 0};n.forEach(function(e){if(e.property.type===v.TYPE_VISIBILITY&&(t.isVisible=e.property.value.primitive_value.bool_value),e.property.type===v.TYPE_ENABLED&&(t.isDisabled=!e.property.value.primitive_value.bool_value),e.property.type===v.TYPE_PADDING){if(!a)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsPaddingValueToCss is not defined",{key:e.key,type:e.property.type});t.paddingCss=a(e.property.value.padding)}if(e.property.type===v.TYPE_BORDER){if(!u)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsBorderValueToCss is not defined",{key:e.key,type:e.property.type});t.borderCss=u(e.property.value.border)}if(e.property.type===v.TYPE_SHADOW){if(!c)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsShadowValueToCss is not defined",{key:e.key,type:e.property.type});t.shadowCss=c(e.property.value.shadow)}if(e.property.type===v.TYPE_BACKGROUND_COLOR){if(!l)throw new ez.UIEffect.Exception("Got a background color UI effect value but uiEffectsBackgroundColorValueToCss is not defined",{key:e.key,type:e.property.type});t.backgroundColorCss=l(e.property.value.color)}T(t)})},[T,a,u,c,l])});var F=eI.useMemo(function(){return N.paddingCss},[N.paddingCss]),K=eI.useMemo(function(){var e=[i,N.borderCss,N.shadowCss,N.backgroundColorCss].filter(function(e){return O(e)});return e.length>0?e.reduce(function(e,n){return e?(0,n4.css)(R||(R=(0,D.__makeTemplateObject)(["\n                  "," ","\n                "],["\n                  "," ","\n                "])),e,n):n},void 0):void 0},[i,N]);if(!1===N.isVisible)return null;if(w)return x===_.OPTIONAL||x===_.DEGRADABLE_OPTIONAL?null:eI.createElement(ez.ThrowErrorComponent,{error:w});if(m)return x===_.REQUIRED?eI.createElement(ez.ThrowErrorComponent,{error:m}):x===_.OPTIONAL?null:x===_.DEGRADABLE_REQUIRED?P?eI.createElement(eI.Suspense,null,eI.createElement(nq.SV,{key:"".concat(r,"-degradable-required-error-boundary"),onError:function(e){var n=new ez.Component.DegradableRequiredException({legoId:r,legoType:S,cause:e});nz(n),I(n)},fallbackRender:function(){return null}},eI.createElement(n2,{source:{legoId:r}},eI.createElement(P,{legoId:r,legoType:S,css:K,content:Y,executeActions:j,triggerEvents:k,childComponents:V,isVisible:N.isVisible,isDisabled:N.isDisabled})))):eI.createElement(ez.ThrowErrorComponent,{error:m}):x!==_.DEGRADABLE_OPTIONAL?eI.createElement(ez.ThrowErrorComponent,{error:m}):P?eI.createElement(eI.Suspense,null,eI.createElement(nq.SV,{key:"".concat(r,"-degradable-optional-error-boundary"),onError:function(e,n){var t=new ez.Component.DegradableOptionalException({legoId:r,legoType:S,cause:e,data:n});nz(t),I(t)},fallbackRender:function(){return null}},eI.createElement(n2,{source:{legoId:r}},eI.createElement(P,{legoId:r,legoType:S,css:K,content:Y,executeActions:j,triggerEvents:k,childComponents:V,isVisible:N.isVisible,isDisabled:N.isDisabled})))):null;return eI.createElement(n7,{source:{legoId:r,legoType:S},css:F},eI.createElement(eI.Suspense,null,eI.createElement(nq.SV,{key:"".concat(r,"-error-boundary"),onError:function(e,n){if(x===_.DEGRADABLE_OPTIONAL){var t=new ez.Component.DegradableOptionalException({legoId:r,legoType:S,cause:e,data:n});nz(t),y(t)}else if(x===_.DEGRADABLE_REQUIRED){var t=new ez.Component.DegradableRequiredException({legoId:r,legoType:S,cause:e,data:n});nz(t),y(t)}else if(x===_.OPTIONAL){var t=new ez.Component.OptionalException({legoId:r,legoType:S,cause:e,data:n});nz(t),y(t)}else{var t=new ez.Component.RequiredException({legoId:r,legoType:S,cause:e,data:n});nz(t),y(t)}},fallbackRender:function(){return null}},eI.createElement(n2,{source:{legoId:r}},eI.createElement(z,{legoId:r,legoType:S,css:K,content:Y,executeActions:j,triggerEvents:k,childComponents:V,isVisible:N.isVisible,isDisabled:N.isDisabled})))))},n5=function(e){var n=e.groupName,t=e.sectionId,o=n$().response,r=eI.useMemo(function(){return o.getSectionByIdOrThrow(n,t)},[o,n,t]);return eI.createElement(n7,{source:{sectionId:t}},eI.createElement(n2,{source:{groupName:n,sectionId:t}},r.content.map(function(e){return eI.createElement(n9,{key:e,legoId:e})})))},te=function(e){var n=e.groupName,t=n$().response,o=eI.useMemo(function(){return t.getGroupByNameOrThrow(n)},[t,n]);return eI.createElement(n7,{source:{groupName:n}},eI.createElement(n2,{source:{groupName:n}},o.sections.map(function(e,t){return eI.createElement(n5,{key:e.section_id,groupName:n,sectionId:e.section_id})})))},tn=function(e){var n=e.TrackingComponent,t=e.groupNames,o=n$().response,r=nH().session;return eI.createElement(n7,{source:{sessionId:r.id}},eI.createElement(n2,{source:{loggingJSON:o.logging}},n&&eI.createElement(n,null),o.groups.filter(function(e){return t?t.includes(e.group_name):!e.group_name.startsWith("modal_sheet")&&!e.group_name.startsWith("full_screen_modal")}).map(function(e){return eI.createElement(te,{key:e.group_name,groupName:e.group_name})})))},tt=function(e){var n=e.source,t=e.groupNames,o=e.TrackingComponent,r=e.ErrorComponent;return eI.createElement(nq.SV,{resetKeys:[n],fallbackRender:function(e){var n=e.error;return r?eI.createElement(r,{error:n}):null},onError:function(e){if(e instanceof eb)e.isBoundaryError=!0,nz(e);else{var n=new ez.Response.RenderError("Failed to render mosaic response",{cause:e});n.isBoundaryError=!0,nz(n)}}},eI.createElement(n0,{source:n},eI.createElement(tn,{groupNames:t,TrackingComponent:o})))},to=t(477590),tr=function(e){var n=e.legoId,t=n$().response,o=nH().session,r=nF().store;return{state:(0,to.s)(r,function(e){return o.selectComponentState(n,t,e)},nk.X),updateState:eI.useCallback(function(e){return o.updateComponentState(n,e,t)},[o,t])}},ti=t(309088),ts=function(e){var n=e.selector,t=nF().store;return{state:(0,ti.oR)(t,n)}};function ta(){var e=eI.useContext(n1);if(!(null==e?void 0:e.hasMosaicLogging))throw new ez.SDKRuntimeError("MosaicLogging not found in context. Did you forget to wrap your app with <MosaicLoggingContextProvider></MosaicLoggingContextProvider>?");return{attributes:e.attributes}}}}]);
//# sourceMappingURL=68622-47f8efee19e90ad3.js.map
//# debugId=0f4db951-3330-58b7-84c5-4d073b4a8a02
